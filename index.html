<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Movemania – Fußballschule mit Haltung & Herz</title>
    <meta
      name="description"
      content="Movemania: Fußball-Academy (3-18) in der Region Braunschweig."
    />
    <link rel="stylesheet" href="assets/css/fonts.css" />
    <link rel="stylesheet" href="assets/css/site.css" />
  
    <style id="mm-layout-fixes">
      /* Offers: 2 Spalten (Desktop/Laptop), 1 Spalte (Mobile) */
      @media (min-width: 900px) {
        #offersGrid.offerGrid {
          display: grid;
          grid-template-columns: repeat(2, minmax(0, 1fr));
          gap: 18px;
          align-items: start;
        }
        #offersGrid.offerGrid > details.offerAcc {
          margin: 0;
        }
      }

      /* Offer-Accordion Extras (CMS) */
      .offerExtraAcc {
        margin-top: 10px;
        border: 1px solid var(--line);
        border-radius: var(--radius);
        overflow: hidden;
        background: var(--card-bg);
      }
      .offerExtraAcc summary {
        list-style: none;
        cursor: pointer;
        padding: 12px 14px;
        font-weight: 900;
        text-transform: uppercase;
        letter-spacing: .06em;
        font-size: 12px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
      .offerExtraAcc summary::-webkit-details-marker { display: none; }
      .offerExtraAcc .offerExtraIcon {
        font-weight: 900;
        opacity: .7;
      }
      .offerExtraAccBody {
        padding: 12px 14px 14px;
        border-top: 1px solid var(--line);
      }
    </style>

  </head>

  <body>
    <header class="topbar">
      <div class="wrap">
        <div class="nav">
          <div class="brand">
            <!-- Logo: initial hidden, wird nur bei erfolgreichem Load eingeblendet (verhindert Broken-Image) -->
            <img
              class="logo"
              id="logoImg"
              src="assets/img/logo.png"
              alt="Movemania Logo"
              style="display: none"
            />
            <div class="brandText">
              <b>Movemania</b>
              <span>Spaß. Mut. Einsatz.</span>
            </div>
          </div>

          <nav class="menu" id="mainMenu" aria-label="Hauptnavigation">
                        <a href="#home">Home</a>
            <a href="#ueber-uns">Über uns</a>
            <a href="#angebote">Angebote</a>
            <a href="#feedback">Feedback</a>
            <a href="#werte">Werte</a>
            <a href="#trainerteam">Trainerteam</a>
            <a href="#news">News</a>
            <a href="#faqs">FAQs</a>
            <a href="#kontakt">Kontakt</a>
            <a href="#partner">Partner</a>
            <a href="#" id="navShop" target="_blank" rel="noopener noreferrer">Shop</a>
          </nav>

          <!-- Mobile Hamburger -->
          <button
            class="navToggle"
            id="navToggle"
            type="button"
            aria-label="Menü öffnen"
            aria-controls="mainMenu"
            aria-expanded="false"
          >
            <span class="navToggleBar" aria-hidden="true"></span>
            <span class="navToggleBar" aria-hidden="true"></span>
            <span class="navToggleBar" aria-hidden="true"></span>
          </button>
        </div>
      </div>
    </header>

    <main id="home" class="pattern">

      <!-- HERO (nur Video) -->
<section class="hero">
  <div class="wrap heroInner">
    <!-- LEFT -->
    <div class="heroCopy">
      <h1 class="heroTitle" id="heroTitle">
        <span class="heroBrand" id="heroBrand">MOVEMANIA</span>
        <span class="heroClaim" id="heroClaim">
          KINDER STÄRKEN.<br />SPIELER ENTWICKELN.
        </span>
      </h1>

      <p class="heroText" id="heroText">Inhalte laden…</p>

      <!-- CTA Buttons (optional, falls du sie schon eingebaut hast) -->
      <div class="heroCtas" id="heroCtas" aria-label="Anmeldung Links"></div>
    </div>

    <!-- RIGHT -->
    <div class="heroMediaStack">
      <p class="heroVideoTopline" id="heroVideoTopline">Inhalte laden…</p>

      <div class="mediaFrame" id="heroMedia" aria-label="Hero Video">
        <div class="slide isActive">
          <div
            style="
              height: 100%;
              display: grid;
              place-items: center;
              color: rgba(255, 255, 255, 0.85);
              font-weight: 800;
              font-size: 13px;
              padding: 18px;
              text-align: center;
            "
          >
            Inhalte laden…
          </div>
        </div>
      </div>

      <p class="heroSubline" id="heroSubline">Inhalte laden…</p>
    </div>
  </div>
</section>



     <!-- ÜBER UNS -->
<section id="ueber-uns" class="section">
  <div class="wrap">
    <div class="sectionHeadCenter">
      <p class="sectionKicker" id="aboutKicker">Über uns</p>
      <h2 class="sectionTitle" id="aboutTitle">WER WIR SIND</h2>
    </div>

    <div class="aboutGrid">

      <!-- LEFT COLUMN -->
      <div class="aboutMediaCol">

        <!-- TRUST TEXT (über dem Bild) -->
        <div class="aboutTrust" id="aboutTrust" style="display:none">
          <p class="aboutTrustTitle" id="aboutTrustTitle"></p>
          <p class="aboutTrustText" id="aboutTrustText"></p>
        </div>

        <!-- MEDIA -->
        <div class="aboutMedia" id="aboutMedia">
          <div
            style="
              height: 100%;
              display: grid;
              place-items: center;
              color: rgba(11, 16, 32, 0.45);
              font-weight: 900;
              letter-spacing: 0.18em;
              text-transform: uppercase;
              font-size: 11px;
            "
          >
            Bild/Video (Headcoach)
          </div>
        </div>

      </div>

      <!-- RIGHT COLUMN -->
      <div class="card">
        <h3 id="aboutHeadTitle">VORSTELLUNG HEADCOACH</h3>
        <p id="aboutHeadText">Inhalte laden…</p>

        <details class="coachBio" id="headcoachProfile" style="margin-top: 10px">
          <summary class="coachBioSum" id="headcoachProfileSum">Mehr</summary>
          <p id="headcoachProfileText" style="margin-top: 10px">Inhalte laden…</p>
        </details>

        <div class="cardActions">
          <a class="btn btnGhost btnAccent" id="aboutCta" href="#kontakt">
            Kontakt aufnehmen
          </a>
        </div>
      </div>

    </div>
  </div>
</section>
 


      <!-- ANGEBOTE (2. Stelle nach Vorstellung) -->
      <section id="angebote" class="section">
        <div class="wrap">
          <div class="sectionHeadCenter">
            <h2 class="sectionTitle" id="offersSectionTitle">ANGEBOTE</h2>
          </div>

          <div class="offerGrid" id="offersGrid">
            <details class="offerAcc" id="accFeriencamps">
              <summary>
                <span class="offerAccTitle" id="offersFeriencampsTitle">Feriencamps</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersFeriencampsMedia" aria-hidden="true"></div>
                <p id="offersFeriencampsText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersFeriencampsSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accElitecamps">
              <summary>
                <span class="offerAccTitle" id="offersElitecampsTitle">Elitecamps</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersElitecampsMedia" aria-hidden="true"></div>
                <p id="offersElitecampsText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersElitecampsSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accPowerkurse">
              <summary>
                <span class="offerAccTitle" id="offersPowerkurseTitle">Powerkurse</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersPowerkurseMedia" aria-hidden="true"></div>
                <p id="offersPowerkurseText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersPowerkurseSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accElitekurs">
              <summary>
                <span class="offerAccTitle" id="offersElitekursTitle">Elitekurse</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersElitekursMedia" aria-hidden="true"></div>
                <p id="offersElitekursText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersElitekursSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accAthletik">
              <summary>
                <span class="offerAccTitle" id="offersAthletikTitle">Athletiktraining</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersAthletikMedia" aria-hidden="true"></div>
                <p id="offersAthletikText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersAthletikSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accSpielnahIndi">
              <summary>
                <span class="offerAccTitle" id="offersSpielnahIndiTitle"
                  >Spielnahes Individualtraining</span
                >
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersSpielnahIndiMedia" aria-hidden="true"></div>
                <p id="offersSpielnahIndiText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersSpielnahIndiSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accBalls">
              <summary>
                <span class="offerAccTitle" id="offersBallsTitle">Ballschule</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersBallsMedia" aria-hidden="true"></div>
                <p id="offersBallsText">
                  Motorik, Ballgefühl, Koordination – ideal als Fundament (z. B. für Einsteiger).
                </p>
                <div class="subOffers" id="offersBallsSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accKiga">
              <summary>
                <span class="offerAccTitle" id="offersKigaTitle">Fußballkindergarten</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersKigaMedia" aria-hidden="true"></div>
                <p id="offersKigaText">
                  Spielerisches Training für die Kleineren – Bewegung, Spaß und erste Fußball-Basics.
                </p>
                <div class="subOffers" id="offersKigaSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accGeburtstage">
              <summary>
                <span class="offerAccTitle" id="offersBdayTitle">Kindergeburtstage</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersBdayMedia" aria-hidden="true"></div>
                <p id="offersBdayText">
                  Bewegung, Spiele, Fußball-Action – ein Geburtstag, an den sich Kinder gerne erinnern.
                </p>
                <div class="subOffers" id="offersBdaySubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accRentCoach">
              <summary>
                <span class="offerAccTitle" id="offersRentCoachTitle">Rent a Coach</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersRentCoachMedia" aria-hidden="true"></div>
                <p id="offersRentCoachText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersRentCoachSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accTrainerfortbildung">
              <summary>
                <span class="offerAccTitle" id="offersTrainerfortbildungTitle"
                  >Trainerfortbildung</span
                >
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div
                  class="offerMedia"
                  id="offersTrainerfortbildungMedia"
                  aria-hidden="true"
                ></div>
                <p id="offersTrainerfortbildungText">
                  Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.
                </p>
                <div class="subOffers" id="offersTrainerfortbildungSubs"></div>
              </div>
            </details>

            <details class="offerAcc" id="accBeratung">
              <summary>
                <span class="offerAccTitle" id="offersBeratungTitle">Beratung</span>
                <i class="offerAccIcon">+</i>
              </summary>
              <div class="offerAccBody">
                <div class="offerMedia" id="offersBeratungMedia" aria-hidden="true"></div>
                <p id="offersBeratungText">
                  Unterstützung für Vereine, Trainer und Teams – von Konzept bis Fortbildung.
                </p>
                <div class="subOffers" id="offersBeratungSubs"></div>
              </div>
            </details>
          </div>
        </div>
      </section>

      <!-- FEEDBACK (nach Angebot) -->
      <section id="feedback" class="section">
        <div class="wrap">
          <div class="sectionHeadCenter">
            <h2 class="sectionTitle" id="feedbackTitle">FEEDBACK</h2>
            <p class="sectionKicker" id="feedbackKicker">Stimmen von Eltern & Kindern</p>
          </div>

          <div class="stackWrap">
            <!-- 1) FIXE VIDEOS (Code) -->
            <div class="sectionHeadCenter" style="margin-bottom: 12px">
              <h3
                style="
                  margin: 0;
                  font-weight: 900;
                  text-transform: uppercase;
                  letter-spacing: -0.01em;
                  font-size: var(--card-title);
                "
              >
                Ungefiltert! „Das sagen unsere Kids.“
              </h3>
            </div>

            <div class="feedbackGrid" id="videoGrid" aria-label="Video Feedback">
              <div class="card">
                <div
                  class="ytBox"
                  data-yt-id="g8B38aVhbEk"
                  data-yt-title="Feedback Video 1"
                  data-yt-poster="assets/img/feedback-1.jpg"
                >
                  <img
                    class="ytPoster"
                    src="assets/img/feedback-1.jpg"
                    alt="Feedback Video 1 Poster"
                    loading="lazy"
                  />
                  <div class="ytOverlay">
                    <div class="ytOverlayInner">
                      <div class="ytHint">YouTube-Video<br />(lädt erst nach Klick)</div>
                      <button class="ytBtn" type="button">Video laden</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card">
                <div
                  class="ytBox"
                  data-yt-id="2ECsN4PJmbk"
                  data-yt-title="Feedback Video 2"
                  data-yt-poster="assets/img/feedback-2.jpg"
                >
                  <img
                    class="ytPoster"
                    src="assets/img/feedback-2.jpg"
                    alt="Feedback Video 2 Poster"
                    loading="lazy"
                  />
                  <div class="ytOverlay">
                    <div class="ytOverlayInner">
                      <div class="ytHint">YouTube-Video<br />(lädt erst nach Klick)</div>
                      <button class="ytBtn" type="button">Video laden</button>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card">
                <div
                  class="ytBox"
                  data-yt-id="C7KlxjqfPnM"
                  data-yt-title="Feedback Video 3"
                  data-yt-poster="assets/img/feedback-3.jpg"
                >
                  <img
                    class="ytPoster"
                    src="assets/img/feedback-3.jpg"
                    alt="Feedback Video 3 Poster"
                    loading="lazy"
                  />
                  <div class="ytOverlay">
                    <div class="ytOverlayInner">
                      <div class="ytHint">YouTube-Video<br />(lädt erst nach Klick)</div>
                      <button class="ytBtn" type="button">Video laden</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- 2) CMS-FEEDBACK (Texts/Names/etc.) -->
            <div class="sectionHeadCenter" style="margin: 22px 0 12px">
              <h3
                style="
                  margin: 0;
                  font-weight: 900;
                  text-transform: uppercase;
                  letter-spacing: -0.01em;
                  font-size: var(--card-title);
                "
              >
                Was Eltern sagen:
              </h3>
            </div>

            <div class="feedbackGrid" id="feedbackGrid" aria-label="Feedback Texte">
              <div class="card">
                <div class="fbMedia" id="fb1Poster" aria-hidden="true"></div>
                <div class="fbMedia" id="fb1Image" aria-hidden="true"></div>

                <h3 id="fb1Title">FEEDBACK 1</h3>

                <p
                  id="fb1Name"
                  style="
                    margin: -4px 0 10px;
                    color: rgba(11, 16, 32, 0.55);
                    font-weight: 900;
                    letter-spacing: 0.1em;
                    text-transform: uppercase;
                    font-size: 11px;
                  "
                >
                  —
                </p>

                <details class="coachBio fbDetails" id="fb1Details">
                  <summary class="coachBioSum fbSum">
                    Mehr <span class="fbPlus" aria-hidden="true">+</span>
                  </summary>
                  <p id="fb1Text">Kurzer Text/Einordnung (optional).</p>
                </details>
              </div>

              <div class="card">
                <div class="fbMedia" id="fb2Poster" aria-hidden="true"></div>
                <div class="fbMedia" id="fb2Image" aria-hidden="true"></div>

                <h3 id="fb2Title">FEEDBACK 2</h3>

                <p
                  id="fb2Name"
                  style="
                    margin: -4px 0 10px;
                    color: rgba(11, 16, 32, 0.55);
                    font-weight: 900;
                    letter-spacing: 0.1em;
                    text-transform: uppercase;
                    font-size: 11px;
                  "
                >
                  —
                </p>

                <details class="coachBio fbDetails" id="fb2Details">
                  <summary class="coachBioSum fbSum">
                    Mehr <span class="fbPlus" aria-hidden="true">+</span>
                  </summary>
                  <p id="fb2Text">Kurzer Text/Einordnung (optional).</p>
                </details>
              </div>

              <div class="card">
                <div class="fbMedia" id="fb3Poster" aria-hidden="true"></div>
                <div class="fbMedia" id="fb3Image" aria-hidden="true"></div>

                <h3 id="fb3Title">FEEDBACK 3</h3>

                <p
                  id="fb3Name"
                  style="
                    margin: -4px 0 10px;
                    color: rgba(11, 16, 32, 0.55);
                    font-weight: 900;
                    letter-spacing: 0.1em;
                    text-transform: uppercase;
                    font-size: 11px;
                  "
                >
                  —
                </p>

                <details class="coachBio fbDetails" id="fb3Details">
                  <summary class="coachBioSum fbSum">
                    Mehr <span class="fbPlus" aria-hidden="true">+</span>
                  </summary>
                  <p id="fb3Text">Kurzer Text/Einordnung (optional).</p>
                </details>
              </div>

              <div class="card">
                <div class="fbMedia" id="fb4Poster" aria-hidden="true"></div>
                <div class="fbMedia" id="fb4Image" aria-hidden="true"></div>

                <h3 id="fb4Title">FEEDBACK 4</h3>

                <p
                  id="fb4Name"
                  style="
                    margin: -4px 0 10px;
                    color: rgba(11, 16, 32, 0.55);
                    font-weight: 900;
                    letter-spacing: 0.1em;
                    text-transform: uppercase;
                    font-size: 11px;
                  "
                >
                  —
                </p>

                <details class="coachBio fbDetails" id="fb4Details">
                  <summary class="coachBioSum fbSum">
                    Mehr <span class="fbPlus" aria-hidden="true">+</span>
                  </summary>
                  <p id="fb4Text">Kurzer Text/Einordnung (optional).</p>
                </details>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- WERTE -->
      <section id="werte" class="usp">
        <div class="wrap">
          <div class="uspHead">
            <div class="uspGhost" id="uspGhost">WERTE</div>
            <p class="uspKicker" id="uspKicker">Wofür wir stehen</p>
            <h2 class="uspTitle" id="uspTitle">SPAß · MUT · EINSATZ</h2>
          </div>

          <div class="cards" id="valuesGrid" aria-label="Werte">
            <div class="card">
              <div class="valueTop">
                <span class="valueIcon"
                  ><span
                    style="
                      font-weight: 900;
                      letter-spacing: 0.18em;
                      font-size: 11px;
                      color: rgba(11, 16, 32, 0.55);
                    "
                    >ICON</span
                  ></span
                >
                <h3>MUT</h3>
              </div>
              <p>
                Wir stärken Kinder, Entscheidungen zu treffen, Verantwortung zu übernehmen und sich etwas
                zuzutrauen.
              </p>
            </div>
          </div>
        </div>
      </section>

      <!-- TRAINERTEAM -->
      <section id="trainerteam" class="section">
        <div class="wrap">
          <div class="sectionHeadCenter" style="margin-bottom: 10px">
            <h2 class="sectionTitle" id="coachSectionTitle">TRAINERTEAM</h2>
          </div>

          <div class="peopleGrid" id="coachGrid" aria-label="Coaches">
            <!-- Platzhalter: wird durch CMS ersetzt -->
            <div class="person">
              <div class="ph">Coach</div>
              <div class="personBody">
                <b>Vorname Nachname</b>
                <small>Rolle / Schwerpunkt</small>

                <details class="coachBio">
                  <summary class="coachBioSum">Mehr</summary>
                  <p>Kurzprofil / Schwerpunkt (Platzhalter).</p>
                </details>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- NEWS (Hero-Slider-Inhalte 2/3 landen hier sichtbar) -->
      <section id="news" class="section">
        <div class="wrap">
          <div class="sectionHeadCenter">
            <h2 class="sectionTitle" id="newsTitle">NEWS</h2>
            <p class="sectionKicker" id="newsKicker">Aktuelles & Einblicke</p>
          </div>

          <div class="cards" id="newsGrid" aria-label="News">
            <div class="card">
              <div
                style="
                  height: 160px;
                  display: grid;
                  place-items: center;
                  color: rgba(11, 16, 32, 0.45);
                  font-weight: 900;
                  letter-spacing: 0.18em;
                  text-transform: uppercase;
                  font-size: 11px;
                  border: 1px solid var(--line);
                  border-radius: var(--radius);
                "
              >
                Inhalte laden…
              </div>
              <h3 style="margin-top: 12px">NEWS</h3>
              <p>Hier erscheinen Inhalte aus news.json (CMS).</p>
            </div>
          </div>
        </div>
      </section>

      <!-- FAQS -->
      <section id="faqs" class="section">
        <div class="wrap">
          <div class="sectionHeadCenter">
            <h2 class="sectionTitle" id="faqTitle">FAQs</h2>
          </div>

          <div class="stackWrap">
            <div class="faq" id="faqBox">
              <div class="faqItem">
                <button class="faqQ" type="button"><span>1. Frage (Platzhalter)</span><i>+</i></button>
                <div class="faqA">Antworttext (Platzhalter). Kann später aus dem CMS geladen werden.</div>
              </div>
            </div>

            <p
              style="
                margin: 14px 0 0;
                color: rgba(11, 16, 32, 0.55);
                font-size: 12px;
                line-height: 1.7;
                text-align: center;
              "
              id="faqHint"
            >
              Hast du weitere Fragen? Dann nimm Kontakt per E-Mail auf.
            </p>
          </div>
        </div>
      </section>

      <!-- KONTAKT -->
      <section id="kontakt" class="section">
        <div class="wrap">
          <div class="sectionHeadCenter">
            <h2 class="sectionTitle">KONTAKT</h2>
          </div>

          <div class="kontaktGrid">
            <a class="kontaktCard" id="kMail" href="#" rel="noreferrer">
              <div>
                <b>E-Mail</b>
                <small id="kMailText">Direkt schreiben</small>
              </div>
              <div class="kontaktIcon" id="kMailIcon"><span id="kMailIconFallback">MAIL</span></div>
            </a>

            <a class="kontaktCard" id="kIG" href="#" target="_blank" rel="noopener noreferrer">
              <div>
                <b>Instagram</b>
                <small id="kIGText">Updates & Einblicke</small>
              </div>
              <div class="kontaktIcon" id="kIGIcon"><span id="kIGIconFallback">IG</span></div>
            </a>

            <a class="kontaktCard" id="kWA" href="#" target="_blank" rel="noopener noreferrer">
              <div>
                <b>WhatsApp</b>
                <small id="kWAText">Community / Infos</small>
              </div>
              <div class="kontaktIcon" id="kWAIcon"><span id="kWAIconFallback">WA</span></div>
            </a>
          </div>
        </div>
      </section>    
      
    <!-- PARTNER -->
      <section id="partner" class="section">
        <div class="wrap">
          <div class="sectionHeadCenter">
            <h2 class="sectionTitle">PARTNER</h2>
          </div>

          <div class="sponsorsBar" id="sponsorsBar" style="margin-top: 14px">
            <div class="sponsorsItems" id="sponsorsItems">
              <span class="sponsorsEmpty">Partner-Logos folgen</span>
            </div>
            <div class="sponsorsLabel" id="sponsorsLabel" style="display: none">Partner</div>
          </div>
        </div>
      </section>
    </main>

<footer>
  <div class="wrap" style="position: relative">
    <b style="color: var(--ink)">Movemania </b><br />
    Fußballschule mit Haltung &amp; Herz
    <div style="margin-top: 12px; display: flex; gap: 12px; flex-wrap: wrap">
      <a class="btn btnGhost" href="/impressum.html">Impressum</a>
      <a class="btn btnGhost" href="/datenschutz.html">Datenschutz</a>
      <a class="btn btnGhost" href="/agbs.html">AGBs</a>
    </div>
  </div>
</footer>


    <!-- Cookie Opt-in -->
    <div class="cc" id="cc">
      <h4>Cookie-Einstellungen</h4>
      <p>
        Wir verwenden keine Tracking- oder Marketing-Cookies. Technisch notwendige Speicherungen erfolgen nur
        mit Ihrer Zustimmung. YouTube-Videos werden erst nach Zustimmung und Klick geladen.
      </p>

      <div class="ccActions">
        <button class="btn btnBlue" id="ccAccept" type="button">Akzeptieren</button>
        <button class="btn btnGhost" id="ccDecline" type="button">Ablehnen</button>
      </div>

      <small>
        Weitere Informationen finden Sie in der
        <a href="/datenschutz.html">Datenschutzerklärung</a>.
      </small>
    </div>

    <script>
      async function loadJSON(path) {
        const url = path + (path.includes("?") ? "&" : "?") + "v=" + Date.now();
        const res = await fetch(url, { cache: "no-store" });
        if (!res.ok) throw new Error("Failed to load " + path + " (" + res.status + ")");
        return await res.json();
      }


      /* ---------------------------
         Security/Hardening Helpers
         --------------------------- */
      function isSafeUrl(url) {
        const s = String(url || "").trim();
        if (!s) return false;

        // block protocol-relative and dangerous schemes
        if (/^\s*\/\//.test(s)) return false;
        if (/^\s*(javascript|vbscript|data):/i.test(s)) return false;

        // allow http(s), mailto, tel, anchors
        if (/^(https?:|mailto:|tel:)/i.test(s)) return true;
        if (/^#/.test(s)) return true;

        // allow relative paths like /..., ./..., ../..., assets/...
        if (/^(\/|\.\/|\.\.\/|assets\/)/i.test(s)) return true;

        // allow generic relative like "img/foo.jpg" or "content/x.json"
        // but block anything containing ":" (to avoid scheme tricks)
        if (s.includes(":")) return false;
        if (/^[a-z0-9_\-]+(\/|$)/i.test(s)) return true;

        return false;
      }

      function safeUrl(url) {
        return isSafeUrl(url) ? String(url).trim() : "";
      }

      function clearEl(el) {
        if (!el) return;
        while (el.firstChild) el.removeChild(el.firstChild);
      }

      function setHref(id, url) {
        const el = document.getElementById(id);
        const u = safeUrl(url);
        if (el && u) el.href = u;
      }

      function setText(id, value) {
        const el = document.getElementById(id);
        if (!el || value === undefined || value === null) return;
        const v = String(value).trim();
        if (!v) return;
        el.textContent = v;
      }

      // erlaubt nur <br>, entfernt alle anderen Tags, setzt dann innerHTML bewusst
      function setHtmlAllowBr(id, value) {
        const el = document.getElementById(id);
        if (!el || value === undefined || value === null) return;
        const raw = String(value).trim();
        if (!raw) return;

        const BR = "__BR__";
        let v = raw.replace(/<\s*br\s*\/?\s*>/gi, BR);
        v = v.replace(/<[^>]*>/g, "");
        v = v.replace(new RegExp(BR, "g"), "<br>");
        el.innerHTML = v;
      }

      function setTextWithBreaks(el, value) {
        if (!el || value === undefined || value === null) return;
        const raw = String(value).trim();
        if (!raw) return;

        const safe = raw
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/\r\n|\r|\n/g, "<br>");

        el.innerHTML = safe;
      }

      function normalizeMailto(input) {
        if (!input) return "";
        const raw = String(input).trim();
        if (!raw) return "";
        if (/^mailto:/i.test(raw)) return raw;
        if (raw.includes("@")) return "mailto:" + raw;
        return raw;
      }

      function mountOptionalImage(containerId, src, alt) {
        const el = document.getElementById(containerId);
        if (!el) return;
        const s = safeUrl(src);
        if (!s) return;

        clearEl(el);
        const img = document.createElement("img");
        img.src = s;
        img.alt = (alt || "").toString().trim() || "Bild";
        img.loading = "lazy";
        img.referrerPolicy = "no-referrer";
        el.appendChild(img);
        el.style.display = "block";
      }

      function mountContactIcon(containerId, src, alt) {
        const el = document.getElementById(containerId);
        if (!el) return;
        const s = safeUrl(src);
        if (!s) return;

        clearEl(el);
        const img = document.createElement("img");
        img.src = s;
        img.alt = (alt || "").toString().trim() || "Icon";
        img.loading = "lazy";
        img.referrerPolicy = "no-referrer";
        el.appendChild(img);
      }

      function applyTheme(theme) {
        const root = document.documentElement;
        const setVar = (k, v) => {
          if (v === undefined || v === null || v === "") return;
          root.style.setProperty(k, v);
        };

        const colors = theme?.colors || {};
        const type = theme?.type || {};
        const layout = theme?.layout || {};
        const pattern = theme?.pattern || {};

        setVar("--bg", colors.bg);
        setVar("--ink", colors.ink);
        setVar("--muted", colors.muted);
        setVar("--line", colors.line);
        setVar("--navy", colors.primary);
        setVar("--red", colors.accent);
        setVar("--card-bg", colors.card_bg);
        setVar("--card-border", colors.card_border);

        if (typeof type.body_size === "number") setVar("--base", type.body_size + "px");
        if (typeof type.hero_title_size === "number") setVar("--hero-title-max", type.hero_title_size + "px");
        if (typeof type.section_title_size === "number") setVar("--section-title", type.section_title_size + "px");
        if (typeof type.card_title_size === "number") setVar("--card-title", type.card_title_size + "px");

        if (typeof layout.content_width === "number") setVar("--max", layout.content_width + "px");
        if (typeof layout.radius === "number") setVar("--radius", layout.radius + "px");

        if (typeof layout.shadow_strength === "number") {
          const s = Math.max(0, Math.min(0.3, layout.shadow_strength));
          setVar("--shadow", `0 14px 40px rgba(11,16,32,${s})`);
        }

        if (pattern.enabled === false) {
          setVar("--patternOpacity", "0");
        } else {
          if (typeof pattern.opacity === "number") setVar("--patternOpacity", String(pattern.opacity));
          if (pattern.dot) setVar("--patternDot", pattern.dot);
          if (typeof pattern.size === "number") setVar("--patternSize", pattern.size + "px");
        }
      }

function mountHeroCtas(links) {
  const host = document.getElementById("heroCtas");
  if (!host) return;

  const raw = Array.isArray(links?.hero_ctas) ? links.hero_ctas : [];

  // fallback: falls noch nichts im CMS gepflegt ist
  const fallback = [
    { label: "Camps anmelden", url: safeUrl(links?.signup_camps || "") },
    { label: "Powerkurse anmelden", url: safeUrl(links?.signup_powerkurse || "") },
    { label: "Kontakt / Anfrage", url: "#kontakt" }
  ];

  const items = (raw.length ? raw : fallback)
    .map((it) => ({
      label: String(it?.label || "").trim(),
      url: safeUrl(it?.url || it?.link || ""),
    }))
    .filter((it) => it.label && it.url)
    .slice(0, 8);

  clearEl(host);

  if (!items.length) {
    host.style.display = "none";
    return;
  }

  host.style.display = "flex";

  items.forEach((it) => {
    const a = document.createElement("a");
    a.className = "btn btnGhost btnAccent";
    a.href = it.url;

    // interne Sprünge (#kontakt) nicht in neuem Tab
    const isAnchor = it.url.startsWith("#");
    if (!isAnchor) {
      a.target = "_blank";
      a.rel = "noopener noreferrer";
    }

    a.textContent = it.label.toUpperCase();
    host.appendChild(a);
  });
}

      
     
      /* HERO: nur Video (autoplay muted + Sound Toggle, full-bleed cover) */
function mountHeroVideo(videoSlide, opts) {
  const heroMedia = document.getElementById("heroMedia");
  if (!heroMedia) return;

  const fallback = {
    type: "video",
    src: "assets/video/hero.mp4",
    poster: "assets/img/hero.jpg",
    title: "Vorstellung",
    text: "",
  };

  const s = videoSlide || fallback;

  // NEW: Headline/Subline aus opts
  const headlineText = String(opts?.headline || "").trim();
  const sublineText = String(opts?.subline || "").trim();

  // Optional: Subline direkt setzen (wenn Element existiert)
  if (sublineText) {
    const subEl = document.getElementById("heroSubline");
    if (subEl) subEl.textContent = sublineText;
  }

  clearEl(heroMedia);

  const wrap = document.createElement("div");
  wrap.className = "slide isActive";
  wrap.style.position = "relative";
  wrap.style.width = "100%";
  wrap.style.height = "100%";

  const v = document.createElement("video");
  v.setAttribute("autoplay", "");
  v.setAttribute("playsinline", "");
  v.setAttribute("loop", "");
  v.setAttribute("muted", "");

  v.autoplay = true;
  v.loop = true;
  v.muted = true;          // Autoplay-safe
  v.playsInline = true;
  v.preload = "metadata";

  // Full-bleed cover
  v.style.width = "100%";
  v.style.height = "100%";
  v.style.display = "block";
  v.style.objectFit = "cover";
  v.style.objectPosition = "center";

  const poster = safeUrl(s?.poster || "");
  if (poster) v.poster = poster;

  const source = document.createElement("source");
  source.src = safeUrl(s?.src || "") || "assets/video/hero.mp4";
  source.type = "video/mp4";
  v.appendChild(source);

  v.addEventListener(
    "loadedmetadata",
    () => { v.play().catch(() => {}); },
    { once: true }
  );

  wrap.appendChild(v);

  // Optional: bestehender Overlay (unten) – kannst du lassen
  if (s?.title || s?.text) {
    const overlay = document.createElement("div");
    overlay.className = "slideOverlay";

    const b = document.createElement("b");
    b.textContent = String(s?.title || "").toUpperCase();
    overlay.appendChild(b);

    if (s?.text) {
      const p = document.createElement("p");
      p.textContent = String(s?.text || "");
      overlay.appendChild(p);
    }

    wrap.appendChild(overlay);
  }

  // Sound Toggle Button
  const soundBtn = document.createElement("button");
  soundBtn.type = "button";
  soundBtn.className = "btn btnGhost btnAccent";
  soundBtn.style.position = "absolute";
  soundBtn.style.top = "14px";
  soundBtn.style.right = "14px";
  soundBtn.style.zIndex = "10";
  soundBtn.style.pointerEvents = "auto";

  const syncSoundLabel = () => {
    soundBtn.textContent = v.muted ? "TON AN" : "TON AUS";
    soundBtn.setAttribute("aria-pressed", v.muted ? "false" : "true");
  };

  const toggleSound = () => {
    v.muted = !v.muted;
    if (!v.muted) v.volume = 1;
    v.play().catch(() => {});
    syncSoundLabel();
  };

  soundBtn.addEventListener("click", (e) => {
    e.stopPropagation();
    toggleSound();
  });

  syncSoundLabel();

  wrap.appendChild(soundBtn);
  heroMedia.appendChild(wrap);
}


      /* NEWS: zeigt alle hero-slides außer Video als Karten */
      function mountNewsFromSlides(slides) {
        const grid = document.getElementById("newsGrid");
        if (!grid) return;

        const list = Array.isArray(slides) ? slides : [];
        const items = list
          .map((s) => ({
            type: String(s?.type || "image").toLowerCase(),
            src: safeUrl(s?.src || ""),
            poster: safeUrl(s?.poster || ""),
            title: String(s?.title || "").trim(),
            text: String(s?.text || "").trim(),
          }))
          .filter((s) => s.type !== "video" && (s.src || s.title || s.text))
          .slice(0, 12);

        if (!items.length) return;

        clearEl(grid);

        items.forEach((it) => {
          const card = document.createElement("div");
          card.className = "card";

          // Media
          if (it.src) {
            const media = document.createElement("div");
            media.className = "offerMedia"; // reuse existing styling if present
            media.style.marginBottom = "12px";
            media.style.height = "160px";
            media.style.borderRadius = "var(--radius)";
            media.style.overflow = "hidden";
            media.style.border = "1px solid var(--line)";
            media.style.display = "block";

            const img = document.createElement("img");
            img.src = it.src;
            img.alt = it.title || "News";
            img.loading = "lazy";
            img.referrerPolicy = "no-referrer";
            media.appendChild(img);

            card.appendChild(media);
          }

          const h3 = document.createElement("h3");
          h3.textContent = (it.title || "NEWS").toUpperCase();
          card.appendChild(h3);

          const p = document.createElement("p");
          p.textContent = it.text || "";
          card.appendChild(p);

          grid.appendChild(card);
        });
      }

/* ---------------------------
   News Lightbox (stabil, robust)
   --------------------------- */
(function initNewsLightboxOnce(){
  if (window.__mmNewsLb) return;

  const state = { items: [], index: 0, startX: null };

  const overlay = document.createElement("div");
  overlay.className = "mmLbOverlay";
  overlay.innerHTML = `
    <div class="mmLbTop">
      <div class="mmLbCap" id="mmLbCap"></div>
      <div class="mmLbBtns">
        <button class="mmLbBtn" type="button" id="mmLbPrev" aria-label="Vorheriges Bild">◀</button>
        <button class="mmLbBtn" type="button" id="mmLbNext" aria-label="Nächstes Bild">▶</button>
        <button class="mmLbBtn" type="button" id="mmLbClose" aria-label="Schließen">✕</button>
      </div>
    </div>
    <div class="mmLbStage">
      <img class="mmLbImg" id="mmLbImg" alt="" />
    </div>
  `;
  document.body.appendChild(overlay);

  const imgEl   = overlay.querySelector("#mmLbImg");
  const capEl   = overlay.querySelector("#mmLbCap");
  const prevEl  = overlay.querySelector("#mmLbPrev");
  const nextEl  = overlay.querySelector("#mmLbNext");
  const closeEl = overlay.querySelector("#mmLbClose");

  function render(){
    const it = state.items[state.index];
    if (!it) return;
    imgEl.src = it.src;
    imgEl.alt = it.alt || "Bild";
    capEl.textContent = it.cap || "";

    const multi = state.items.length > 1;
    prevEl.style.display = multi ? "inline-block" : "none";
    nextEl.style.display = multi ? "inline-block" : "none";
  }

  function openAt(idx){
    if (!state.items.length) return;
    state.index = Math.max(0, Math.min(state.items.length - 1, idx));
    render();
    overlay.classList.add("isOpen");
    document.body.classList.add("mmLbOpen");
  }

  function close(){
    overlay.classList.remove("isOpen");
    document.body.classList.remove("mmLbOpen");
    imgEl.src = "";
  }

  function prev(){
    if (state.items.length < 2) return;
    state.index = (state.index - 1 + state.items.length) % state.items.length;
    render();
  }

  function next(){
    if (state.items.length < 2) return;
    state.index = (state.index + 1) % state.items.length;
    render();
  }

  // Buttons: bombensicher (verhindert Overlay-Click + andere Handler)
  prevEl.addEventListener("click", (e) => {
    e.preventDefault();
    e.stopPropagation();
    if (e.stopImmediatePropagation) e.stopImmediatePropagation();
    prev();
  });

  nextEl.addEventListener("click", (e) => {
    e.preventDefault();
    e.stopPropagation();
    if (e.stopImmediatePropagation) e.stopImmediatePropagation();
    next();
  });

  closeEl.addEventListener("click", (e) => {
    e.preventDefault();
    e.stopPropagation();
    if (e.stopImmediatePropagation) e.stopImmediatePropagation();
    close();
  });

  // Overlay click: schließt NUR wenn nicht auf Buttons/Bild geklickt wurde
  overlay.addEventListener("click", (e) => {
    // Klick auf Buttons/Buttons-Container => NICHT schließen
    if (e.target.closest("#mmLbPrev") || e.target.closest("#mmLbNext") || e.target.closest("#mmLbClose") || e.target.closest(".mmLbBtns")) {
      return;
    }
    // Klick direkt aufs Bild => NICHT schließen
    if (e.target === imgEl) return;

    close();
  });

  // Keyboard
  document.addEventListener("keydown", (e) => {
    if (!overlay.classList.contains("isOpen")) return;
    if (e.key === "Escape") close();
    if (e.key === "ArrowLeft") prev();
    if (e.key === "ArrowRight") next();
  });

  // Swipe
  imgEl.addEventListener("touchstart", (e) => {
    if (!overlay.classList.contains("isOpen")) return;
    state.startX = e.touches?.[0]?.clientX ?? null;
  }, { passive: true });

  imgEl.addEventListener("touchend", (e) => {
    if (!overlay.classList.contains("isOpen")) return;
    if (state.startX === null) return;

    const endX = e.changedTouches?.[0]?.clientX ?? null;
    if (endX === null) return;

    const dx = endX - state.startX;
    state.startX = null;

    if (Math.abs(dx) < 40) return;
    if (dx > 0) prev(); else next();
  }, { passive: true });

  window.__mmNewsLb = {
    setItems: (items) => { state.items = Array.isArray(items) ? items : []; },
    openAt
  };
})();
      
/* NEWS: aus news.json (CMS) */
function mountNewsFromJson(newsData) {
  const grid = document.getElementById("newsGrid");
  if (!grid || !newsData) return;

  // Optional Headline / Kicker
  if (newsData.title) setText("newsTitle", String(newsData.title).toUpperCase());
  if (newsData.kicker) setText("newsKicker", String(newsData.kicker));

  const items = Array.isArray(newsData.items) ? newsData.items : [];
  if (!items.length) return;

  clearEl(grid);

  items.slice(0, 12).forEach((it) => {
    const card = document.createElement("div");
    card.className = "card";

    /* ---------- MEDIA ---------- */
    const imgUrl = safeUrl(it?.image || "");
    if (imgUrl) {
      const media = document.createElement("div");
      media.className = "offerMedia";
      media.style.marginBottom = "12px";
      media.style.height = "220px";
      media.style.borderRadius = "var(--radius)";
      media.style.overflow = "hidden";
      media.style.border = "1px solid var(--line)";
      media.style.display = "block";
      media.style.background = "rgba(11,16,32,.04)";

      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "mmLbThumbBtn";
      btn.setAttribute("aria-label", "Bild vergrößern");

      const img = document.createElement("img");
      img.src = imgUrl;
      img.alt = String(it?.title || "News");
      img.loading = "lazy";
      img.referrerPolicy = "no-referrer";
      img.style.width = "100%";
      img.style.height = "100%";
      img.style.objectFit = "contain";
      img.style.objectPosition = "center";

      btn.appendChild(img);
      media.appendChild(btn);
      card.appendChild(media);
    }

    /* ---------- TITLE ---------- */
    const h3 = document.createElement("h3");
    h3.textContent = String(it?.title || "NEWS").toUpperCase();
    card.appendChild(h3);

    /* ---------- TEXT ---------- */
    const p = document.createElement("p");
    p.textContent = String(it?.text || "");
    card.appendChild(p);

    /* ---------- LINK ---------- */
    const link = safeUrl(it?.link || "");
    if (link) {
      const actions = document.createElement("div");
      actions.className = "cardActions";

      const a = document.createElement("a");
      a.className = "btn btnGhost btnAccent";
      a.href = link;
      a.target = "_blank";
      a.rel = "noopener noreferrer";
      a.textContent = String(it?.link_label || "Mehr").toUpperCase();

      actions.appendChild(a);
      card.appendChild(actions);
    }

    grid.appendChild(card);
  });

  /* ---- Lightbox wiring (nur News) ---- */
  const thumbs = Array.from(grid.querySelectorAll(".mmLbThumbBtn img"));
  const lbItems = thumbs.map((img) => ({ src: img.src, alt: img.alt, cap: img.alt }));

  if (window.__mmNewsLb && lbItems.length) {
    window.__mmNewsLb.setItems(lbItems);

    thumbs.forEach((img, idx) => {
      const btn = img.closest(".mmLbThumbBtn");
      if (!btn) return;
      btn.addEventListener("click", (e) => {
        e.preventDefault();
        e.stopPropagation();
        window.__mmNewsLb.openAt(idx);
      });
    });
  }
}

      /* ---------------------------
   FAQ: aus faq.json (CMS)
   Erwartete Struktur (flexibel):
   - { title, hint, items:[{ q|question, a|answer, order|sort }] }
   - oder { faqs:[...] } oder direkt [...]
   --------------------------- */
function mountFaq(faqData, hintFallback) {
  const box = document.getElementById("faqBox");
  if (!box || !faqData) return;

  // Optional Title / Hint
  const title = faqData?.title || faqData?.headline;
  if (title) setText("faqTitle", String(title).toUpperCase());

  const hint = faqData?.hint || faqData?.kicker || faqData?.footer_hint || hintFallback;
  if (hint) setText("faqHint", String(hint));

  // Items aus verschiedenen möglichen Keys ziehen
  const raw =
    (Array.isArray(faqData?.items) && faqData.items) ||
    (Array.isArray(faqData?.faqs) && faqData.faqs) ||
    (Array.isArray(faqData?.questions) && faqData.questions) ||
    (Array.isArray(faqData) && faqData) ||
    [];

  if (!raw.length) return;

  // robust sort: order/sort optional, sonst JSON-Reihenfolge
  const toNum = (v) => {
    const n = Number(v);
    return Number.isFinite(n) ? n : null;
  };

  const items = raw
    .slice(0, 100)
    .map((it, idx) => ({
      ...it,
      _idx: idx,
      _order: toNum(it?.order ?? it?.sort),
    }))
    .sort((a, b) => {
      if (a._order !== null && b._order !== null) return a._order - b._order;
      if (a._order !== null) return -1;
      if (b._order !== null) return 1;
      return a._idx - b._idx;
    });

  // Render
  clearEl(box);

  items.slice(0, 20).forEach((it, i) => {
    const q = String(it?.q ?? it?.question ?? it?.title ?? `Frage ${i + 1}`).trim();
    const a = String(it?.a ?? it?.answer ?? it?.text ?? "").trim();

    if (!q || !a) return;

    const item = document.createElement("div");
    item.className = "faqItem";

    const btn = document.createElement("button");
    btn.className = "faqQ";
    btn.type = "button";

    const span = document.createElement("span");
    span.textContent = q;

    const icon = document.createElement("i");
    icon.textContent = "+";

    btn.appendChild(span);
    btn.appendChild(icon);

    const ans = document.createElement("div");
    ans.className = "faqA";
    // Antworten dürfen Zeilenumbrüche enthalten
    setTextWithBreaks(ans, a);

    btn.addEventListener("click", () => {
      const isOpen = item.classList.toggle("isOpen");
      icon.textContent = isOpen ? "–" : "+";
    });

    item.appendChild(btn);
    item.appendChild(ans);
    box.appendChild(item);
  });
}

  
      function initFaq() {
        const box = document.getElementById("faqBox");
        if (!box) return;
        box.querySelectorAll(".faqItem").forEach((item) => {
          const btn = item.querySelector(".faqQ");
          const icon = btn ? btn.querySelector("i") : null;
          if (!btn) return;

          btn.addEventListener("click", () => {
            const isOpen = item.classList.toggle("isOpen");
            if (icon) icon.textContent = isOpen ? "–" : "+";
          });
        });
      }

      function initMobileMenu() {
        const topbar = document.querySelector(".topbar");
        const btn = document.getElementById("navToggle");
        const menu = document.getElementById("mainMenu");
        if (!topbar || !btn || !menu) return;

        const setOpen = (open) => {
          topbar.classList.toggle("isMenuOpen", open);
          btn.setAttribute("aria-expanded", open ? "true" : "false");
          btn.setAttribute("aria-label", open ? "Menü schließen" : "Menü öffnen");
        };

        btn.addEventListener("click", (e) => {
          e.stopPropagation();
          setOpen(!topbar.classList.contains("isMenuOpen"));
        });

        document.addEventListener("click", (e) => {
          if (!topbar.classList.contains("isMenuOpen")) return;
          if (!topbar.contains(e.target)) setOpen(false);
        });

        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape") setOpen(false);
        });

        menu.querySelectorAll("a").forEach((a) => {
          a.addEventListener("click", () => setOpen(false));
        });
      }

      function initFeedbackDetailsPlus() {
        document.querySelectorAll("details.fbDetails").forEach((d) => {
          const plus = d.querySelector(".fbPlus");
          const sync = () => {
            if (plus) plus.textContent = d.open ? "–" : "+";
          };
          sync();
          d.addEventListener("toggle", sync);
        });
      }

      function mountHeadcoachMedia(data) {
        const el = document.getElementById("aboutMedia");
        if (!el) return;

        const img = data?.image ? safeUrl(data.image) : "";
        const vid = data?.video ? safeUrl(data.video) : "";
        const poster = data?.poster ? safeUrl(data.poster) : "";

        clearEl(el);

        if (vid) {
          const video = document.createElement("video");
          video.controls = true;
          video.playsInline = true;
          video.preload = "metadata";
          if (poster) video.poster = poster;

          const source = document.createElement("source");
          source.src = vid;
          source.type = "video/mp4";
          video.appendChild(source);

          el.appendChild(video);
          return;
        }

        if (img) {
          const image = document.createElement("img");
          image.src = img;
          image.alt = "Headcoach";
          image.loading = "lazy";
          image.referrerPolicy = "no-referrer";
          el.appendChild(image);
          return;
        }

        const ph = document.createElement("div");
        ph.style.height = "100%";
        ph.style.display = "grid";
        ph.style.placeItems = "center";
        ph.style.color = "rgba(11,16,32,.45)";
        ph.style.fontWeight = "900";
        ph.style.letterSpacing = ".18em";
        ph.style.textTransform = "uppercase";
        ph.style.fontSize = "11px";
        ph.textContent = "Bild/Video (Headcoach)";
        el.appendChild(ph);
      }

      function mountHeadcoachProfile(data) {
        const details = document.getElementById("headcoachProfile");
        const textEl = document.getElementById("headcoachProfileText");
        if (!details || !textEl) return;

        const profile = String(data?.profile || data?.bio || "").trim();
        if (!profile) {
          details.style.display = "none";
          return;
        }

        details.style.display = "block";
        setTextWithBreaks(textEl, profile);
      }

      function mountCoaches(data) {
        const grid = document.getElementById("coachGrid");
        if (!grid) return;

        const itemsRaw = Array.isArray(data?.coaches) ? data.coaches : [];
        if (!itemsRaw.length) return;

        const items = itemsRaw
          .slice(0, 50)
          .map((c) => ({
            ...c,
            _order:
              typeof c?.order === "number" ? c.order : typeof c?.sort === "number" ? c.sort : null,
          }))
          .sort((a, b) => {
            const ao = a._order,
              bo = b._order;
            if (ao !== null && bo !== null) return ao - bo;
            if (ao !== null) return -1;
            if (bo !== null) return 1;
            const an = String(a?.name || "").toLowerCase();
            const bn = String(b?.name || "").toLowerCase();
            return an.localeCompare(bn, "de");
          });

        clearEl(grid);

        items.slice(0, 12).forEach((c) => {
          const name = String(c?.name || "Coach");
          const role = String(c?.role || "").trim();
          const bio = String(c?.bio || "").trim();
          const imageUrl = safeUrl(c?.image || "");

          const card = document.createElement("div");
          card.className = "person";

          if (imageUrl) {
            const img = document.createElement("img");
            img.src = imageUrl;
            img.alt = name;
            img.loading = "lazy";
            img.referrerPolicy = "no-referrer";
            card.appendChild(img);
          } else {
            const ph = document.createElement("div");
            ph.className = "ph";
            ph.textContent = "Coach";
            card.appendChild(ph);
          }

          const body = document.createElement("div");
          body.className = "personBody";

          const b = document.createElement("b");
          b.textContent = name.toUpperCase();
          body.appendChild(b);

          if (role) {
            const small = document.createElement("small");
            small.textContent = role;
            body.appendChild(small);
          }

          if (bio) {
            const details = document.createElement("details");
            details.className = "coachBio";

            const sum = document.createElement("summary");
            sum.className = "coachBioSum";
            sum.textContent = "Mehr";
            details.appendChild(sum);

            const p = document.createElement("p");
            p.textContent = bio;
            details.appendChild(p);

            body.appendChild(details);
          }

          card.appendChild(body);
          grid.appendChild(card);
        });
      }

      function mountSponsors(data) {
        const label = document.getElementById("sponsorsLabel");
        const itemsEl = document.getElementById("sponsorsItems");
        if (!itemsEl) return;

        const title = data && (data.title || data.label);
        if (label && title) label.textContent = String(title);

        const items = Array.isArray(data?.items)
          ? data.items
          : Array.isArray(data?.sponsors)
          ? data.sponsors
          : Array.isArray(data)
          ? data
          : [];

        if (!items.length) return;

        clearEl(itemsEl);

        const withLogo = items.filter((it) => it && it.logo && safeUrl(it.logo));
        if (!withLogo.length) {
          const sp = document.createElement("span");
          sp.className = "sponsorsEmpty";
          sp.textContent = "Partner-Logos folgen";
          itemsEl.appendChild(sp);
          return;
        }

        withLogo.slice(0, 12).forEach((it) => {
          const name = String(it?.name || "Partner");
          const url = safeUrl(it?.url || "");
          const logo = safeUrl(it?.logo || "");
          if (!logo) return;

          const wrapper = document.createElement(url ? "a" : "span");
          wrapper.className = "sponsorLink";

          if (url) {
            wrapper.href = url;
            wrapper.target = "_blank";
            wrapper.rel = "noopener noreferrer";
          }

          const img = document.createElement("img");
          img.src = logo;
          img.alt = name || "Partner";
          img.loading = "lazy";
          img.referrerPolicy = "no-referrer";
          wrapper.appendChild(img);

          itemsEl.appendChild(wrapper);
        });
      }

      function mountValues(valuesData) {
        const defaultValues = [
          {
            title: "Mut",
            text: "Wir stärken Kinder, Entscheidungen zu treffen, Verantwortung zu übernehmen und sich etwas zuzutrauen.",
            icon: "assets/img/icons/mut.svg",
          },
          {
            title: "Einsatz",
            text: "Leistung entsteht durch Freude am Training, Dranbleiben und gemeinsames Arbeiten an Zielen.",
            icon: "assets/img/icons/einsatz.svg",
          },
          {
            title: "Respekt",
            text: "Respekt, Fairness und ein positives Miteinander sind bei uns nicht verhandelbar.",
            icon: "assets/img/icons/respekt.svg",
          },
        ];

        const values =
          Array.isArray(valuesData?.items) && valuesData.items.length
            ? valuesData.items
            : Array.isArray(valuesData?.values) && valuesData.values.length
            ? valuesData.values
            : defaultValues;

        const grid = document.getElementById("valuesGrid");
        if (!grid) return;

        clearEl(grid);

        values.slice(0, 6).forEach((v) => {
          const card = document.createElement("div");
          card.className = "card";

          const top = document.createElement("div");
          top.className = "valueTop";

          const iconWrap = document.createElement("span");
          iconWrap.className = "valueIcon";

          const iconUrl = safeUrl(v?.icon || "");
          if (iconUrl) {
            const img = document.createElement("img");
            img.src = iconUrl;
            img.alt = String(v?.icon_alt || v?.title || "Icon");
            img.loading = "lazy";
            img.referrerPolicy = "no-referrer";
            iconWrap.appendChild(img);
          }

          const h3 = document.createElement("h3");
          h3.textContent = String(v?.title || "").toUpperCase();

          top.appendChild(iconWrap);
          top.appendChild(h3);

          const p = document.createElement("p");
          p.textContent = String(v?.text || "");

          card.appendChild(top);
          card.appendChild(p);

          grid.appendChild(card);
        });
      }

  function mountOffers(offersData) {
  console.log("mountOffers called with:", offersData);

  // Robust: akzeptiert beide Strukturen (offers / offers.offers) + Notfall flat
  const offers = offersData?.offers?.offers ?? offersData?.offers ?? offersData ?? {};
  const extras = Array.isArray(offersData?.extras) ? offersData.extras : [];

  /* ---------------------------
     Helpers (lokal)
     --------------------------- */
  const escapeHtml = (str) =>
  String(str || "").replace(/[&<>"']/g, (m) => ({
    "&": "&amp;",
    "<": "&lt;",
    ">": "&gt;",
    '"': "&quot;",
    "'": "&#039;",
  }[m]));

const linkifyEmailsToMailto = (escapedText) =>
  String(escapedText || "").replace(
    /([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,})/gi,
    '<a class="inlineMail" href="mailto:$1">$1</a>'
  );

// safe: erst escapen, dann mail-linkify, dann \n -> <br>
const setTextWithBreaksAndMailto = (el, raw) => {
  if (!el) return;
  const v = String(raw || "").trim();
  if (!v) return;

  const safe = escapeHtml(v);
  el.innerHTML = linkifyEmailsToMailto(safe).replace(/\n/g, "<br>");
};

    
  const addOptionalLinkButton = (containerEl, link, label, cssClass) => {
    if (!containerEl) return;
    const href = safeUrl(link);
    if (!href) return;

    const a = document.createElement("a");
    a.className = (cssClass || "btn btnGhost") + " btnAccent";
    a.href = href;
    a.target = "_blank";
    a.rel = "noopener noreferrer";
    a.textContent = String(label || "Mehr").toUpperCase();

    const wrap = document.createElement("div");
    wrap.className = "cardActions";
    wrap.appendChild(a);
    containerEl.appendChild(wrap);
  };

  const renderSubs = (subsElId, subs) => {
    const el = document.getElementById(subsElId);
    if (!el) return;

    const list = Array.isArray(subs) ? subs : [];
    if (!list.length) {
      // wenn keine Subs: Container leeren, aber nicht entfernen
      clearEl(el);
      return;
    }

    clearEl(el);

    list.slice(0, 6).forEach((s) => {
      const div = document.createElement("div");
      div.className = "subCard";

      const b = document.createElement("b");
      b.textContent = String(s?.title || "Unterpunkt");
      div.appendChild(b);

      const small = document.createElement("small");
      setTextWithBreaksAndMailto(small, String(s?.text || ""));
      div.appendChild(small);

      const link = safeUrl(s?.link || "");
      if (link) {
        const mt = document.createElement("div");
        mt.style.marginTop = "8px";

        const a = document.createElement("a");
        a.className = "btn btnGhost btnAccent";
        a.href = link;
        a.target = "_blank";
        a.rel = "noopener noreferrer";
        a.textContent = String(s?.link_label || "Mehr").toUpperCase();

        mt.appendChild(a);
        div.appendChild(mt);
      }

      el.appendChild(div);
    });
  };

  // ✅ Sicheres Text-Setzen: niemals den ganzen Body löschen
  // Erwartung: <p id="...Text"> existiert im jeweiligen .offerAccBody
  // Falls nicht: wird ein <p> nachträglich angelegt (ohne Media/Subs zu zerstören)
  const setOfferBodyText = (accId, textId, value) => {
    const body = document.querySelector(`#${accId} .offerAccBody`);
    if (!body) return;

    const v = String(value || "").trim();
    if (!v) return;

    let target = document.getElementById(textId);

    // Wenn target nicht existiert ODER nicht im body liegt, lege es an (aber ohne body zu leeren)
    if (!target || !body.contains(target)) {
      // versuche: erstes <p> im body, ansonsten neu
      target = body.querySelector("p") || document.createElement("p");
      if (!target.id) target.id = textId;

      // wenn das <p> noch nicht im DOM hängt: vor Subs einfügen (falls vorhanden)
      if (!body.contains(target)) {
        const subs = body.querySelector(".subOffers");
        const media = body.querySelector(".offerMedia");
        // Reihenfolge: Media -> Text -> Subs
        if (media && media.nextSibling) {
          body.insertBefore(target, media.nextSibling);
        } else if (subs) {
          body.insertBefore(target, subs);
        } else {
          body.appendChild(target);
        }
      }
    }

    setTextWithBreaksAndMailto(target, v);
  };

  // Rendert "Extra-Accordions" innerhalb des Sub-Containers (oder am Ende)
  const renderOfferAccordions = (hostElId, accordions) => {
    const host = document.getElementById(hostElId);
    if (!host) return;

    const list = Array.isArray(accordions) ? accordions : [];
    if (!list.length) return;

    // NICHT clearEl(host) hier – könnte Subs enthalten.
    // Wir hängen Extras einfach hinten dran.
    list.slice(0, 6).forEach((a) => {
      const d = document.createElement("details");
      d.className = "offerExtraAcc";

      const sum = document.createElement("summary");
      sum.innerHTML = `
        <span>${String(a?.title || "Mehr")}</span>
        <span class="offerExtraIcon">+</span>
      `;
      d.appendChild(sum);

      const body = document.createElement("div");
      body.className = "offerExtraAccBody";
      // Text mit Breaks (keine HTML-Tags zulassen)
      setTextWithBreaksAndMailto(body, String(a?.text || ""));
      d.appendChild(body);

      // Optional Link in Extra
      const link = safeUrl(a?.link || "");
      if (link) {
        const actions = document.createElement("div");
        actions.className = "cardActions";
        actions.style.marginTop = "10px";

        const btn = document.createElement("a");
        btn.className = "btn btnGhost btnAccent";
        btn.href = link;
        btn.target = "_blank";
        btn.rel = "noopener noreferrer";
        btn.textContent = String(a?.link_label || "Mehr").toUpperCase();

        actions.appendChild(btn);
        body.appendChild(actions);
      }

      // +/- Sync
      const icon = sum.querySelector(".offerExtraIcon");
      const sync = () => { if (icon) icon.textContent = d.open ? "–" : "+"; };
      sync();
      d.addEventListener("toggle", sync);

      host.appendChild(d);
    });
  };

  // Shortcut, um ein einzelnes Offer zu mounten (macht Code sauber)
  const mountOne = (cfg) => {
    const {
      key,
      accId,
      titleId,
      textId,
      mediaId,
      subsId
    } = cfg;

    const o = offers?.[key];
    if (!o) return;

    // Title
    setText(titleId, o.title || cfg.fallbackTitle);

    // Text
    setOfferBodyText(accId, textId, o.text);

    // Media
    mountOptionalImage(mediaId, o.image, o.title || cfg.fallbackTitle);

    // Link Button (in Body)
    const body = document.querySelector(`#${accId} .offerAccBody`);
    addOptionalLinkButton(body, o.link, o.link_label || "Mehr", "btn btnGhost");

    // Subs
    renderSubs(subsId, o.sub);

    // Extra-Accordions
    renderOfferAccordions(subsId, o.accordions);
  };

  /* ---------------------------
     Mount all offers
     --------------------------- */

  mountOne({
    key: "feriencamps",
    accId: "accFeriencamps",
    titleId: "offersFeriencampsTitle",
    textId: "offersFeriencampsText",
    mediaId: "offersFeriencampsMedia",
    subsId: "offersFeriencampsSubs",
    fallbackTitle: "Feriencamps",
  });

  mountOne({
    key: "elitecamps",
    accId: "accElitecamps",
    titleId: "offersElitecampsTitle",
    textId: "offersElitecampsText",
    mediaId: "offersElitecampsMedia",
    subsId: "offersElitecampsSubs",
    fallbackTitle: "Elitecamps",
  });

  mountOne({
    key: "powerkurse",
    accId: "accPowerkurse",
    titleId: "offersPowerkurseTitle",
    textId: "offersPowerkurseText",
    mediaId: "offersPowerkurseMedia",
    subsId: "offersPowerkurseSubs",
    fallbackTitle: "Powerkurse",
  });

  // Achtung: dein HTML-ID heißt accElitekurs / offersElitekursTitle
  // JSON-Key bei dir ist elitekurse (so steht’s im bisherigen Code)
  mountOne({
    key: "elitekurse",
    accId: "accElitekurs",
    titleId: "offersElitekursTitle",
    textId: "offersElitekursText",
    mediaId: "offersElitekursMedia",
    subsId: "offersElitekursSubs",
    fallbackTitle: "Elitekurse",
  });

  mountOne({
    key: "athletik",
    accId: "accAthletik",
    titleId: "offersAthletikTitle",
    textId: "offersAthletikText",
    mediaId: "offersAthletikMedia",
    subsId: "offersAthletikSubs",
    fallbackTitle: "Athletiktraining",
  });

  // JSON-Key spielnah_individual
  mountOne({
    key: "spielnah_individual",
    accId: "accSpielnahIndi",
    titleId: "offersSpielnahIndiTitle",
    textId: "offersSpielnahIndiText",
    mediaId: "offersSpielnahIndiMedia",
    subsId: "offersSpielnahIndiSubs",
    fallbackTitle: "Spielnahes Individualtraining",
  });

  mountOne({
    key: "ballschule",
    accId: "accBalls",
    titleId: "offersBallsTitle",
    textId: "offersBallsText",
    mediaId: "offersBallsMedia",
    subsId: "offersBallsSubs",
    fallbackTitle: "Ballschule",
  });

  // JSON-Key kiga
  mountOne({
    key: "kiga",
    accId: "accKiga",
    titleId: "offersKigaTitle",
    textId: "offersKigaText",
    mediaId: "offersKigaMedia",
    subsId: "offersKigaSubs",
    fallbackTitle: "Fußballkindergarten",
  });

  mountOne({
    key: "geburtstage",
    accId: "accGeburtstage",
    titleId: "offersBdayTitle",
    textId: "offersBdayText",
    mediaId: "offersBdayMedia",
    subsId: "offersBdaySubs",
    fallbackTitle: "Kindergeburtstage",
  });

  // JSON-Key rent_a_coach
  mountOne({
    key: "rent_a_coach",
    accId: "accRentCoach",
    titleId: "offersRentCoachTitle",
    textId: "offersRentCoachText",
    mediaId: "offersRentCoachMedia",
    subsId: "offersRentCoachSubs",
    fallbackTitle: "Rent a Coach",
  });

  mountOne({
    key: "trainerfortbildung",
    accId: "accTrainerfortbildung",
    titleId: "offersTrainerfortbildungTitle",
    textId: "offersTrainerfortbildungText",
    mediaId: "offersTrainerfortbildungMedia",
    subsId: "offersTrainerfortbildungSubs",
    fallbackTitle: "Trainerfortbildung",
  });

  mountOne({
    key: "beratung",
    accId: "accBeratung",
    titleId: "offersBeratungTitle",
    textId: "offersBeratungText",
    mediaId: "offersBeratungMedia",
    subsId: "offersBeratungSubs",
    fallbackTitle: "Beratung",
  });

  // Icons +/– sync (Details)
  document.querySelectorAll("details.offerAcc").forEach((d) => {
    const icon = d.querySelector(".offerAccIcon");
    const sync = () => { if (icon) icon.textContent = d.open ? "–" : "+"; };
    sync();
    d.addEventListener("toggle", sync);
  });

  // Debug optional
  // console.log("offers extras:", extras);
}



  function mountFeedbackFromJson(feedbackData) {
  if (!feedbackData) return;

  if (feedbackData.title) setText("feedbackTitle", String(feedbackData.title).toUpperCase());
  if (feedbackData.kicker) setText("feedbackKicker", feedbackData.kicker);

  const grid = document.getElementById("feedbackGrid");
  if (!grid) return;

  const raw = Array.isArray(feedbackData.items) ? feedbackData.items : [];
  if (!raw.length) return;

  // Netlify CMS / JSON: Numbers können als String kommen -> robust casten
  const toNum = (v) => {
    const n = Number(v);
    return Number.isFinite(n) ? n : null;
  };

  // Optional: Sortierung über "order" (oder "sort") ermöglichen
  const items = raw
    .slice(0, 50)
    .map((it, idx) => ({
      ...it,
      _idx: idx,
      _order: toNum(it?.order ?? it?.sort),
    }))
    .sort((a, b) => {
      // 1) order/sort aufsteigend
      if (a._order !== null && b._order !== null) return a._order - b._order;
      if (a._order !== null) return -1;
      if (b._order !== null) return 1;
      // 2) sonst Reihenfolge wie im JSON
      return a._idx - b._idx;
    });

  // Grid komplett neu aufbauen
  clearEl(grid);

  items.forEach((it) => {
    const title = String(it?.title || "FEEDBACK").trim();
    const name = String(it?.name || "").trim();
    const text = String(it?.text || "").trim();
    const poster = safeUrl(it?.poster || "");
    const image = safeUrl(it?.image || "");

    const card = document.createElement("div");
    card.className = "card";

    // Media: poster zuerst, dann image (falls beide)
    if (poster) {
      const mediaPoster = document.createElement("div");
      mediaPoster.className = "fbMedia";

      const img = document.createElement("img");
      img.src = poster;
      img.alt = (title ? title + " " : "") + "Poster";
      img.loading = "lazy";
      img.referrerPolicy = "no-referrer";

      mediaPoster.appendChild(img);
      card.appendChild(mediaPoster);
    }

    if (image) {
      const mediaImg = document.createElement("div");
      mediaImg.className = "fbMedia";

      const img = document.createElement("img");
      img.src = image;
      img.alt = (title ? title + " " : "") + "Bild";
      img.loading = "lazy";
      img.referrerPolicy = "no-referrer";

      mediaImg.appendChild(img);
      card.appendChild(mediaImg);
    }

    // Title
    const h3 = document.createElement("h3");
    h3.textContent = (title || "FEEDBACK").toUpperCase();
    card.appendChild(h3);

    // Name
    const pName = document.createElement("p");
    pName.style.margin = "-4px 0 10px";
    pName.style.color = "rgba(11, 16, 32, 0.55)";
    pName.style.fontWeight = "900";
    pName.style.letterSpacing = "0.1em";
    pName.style.textTransform = "uppercase";
    pName.style.fontSize = "11px";
    pName.textContent = name ? name : "—";
    card.appendChild(pName);

    // Text: als Details nur wenn Text vorhanden
    if (text) {
      const details = document.createElement("details");
      details.className = "coachBio fbDetails";

      const summary = document.createElement("summary");
      summary.className = "coachBioSum fbSum";
      summary.innerHTML = `Mehr <span class="fbPlus" aria-hidden="true">+</span>`;
      details.appendChild(summary);

      const p = document.createElement("p");
      setTextWithBreaks(p, text);
      details.appendChild(p);

      card.appendChild(details);
    }

    grid.appendChild(card);
  });

  // +/– Sync für alle neu erzeugten Cards
  initFeedbackDetailsPlus();
}


  function initYouTubeFeedbackEmbeds(consent){
    const boxes = document.querySelectorAll(".ytBox");
    if (!boxes.length) return;

    const openVideoFocus = (iframe) => {
      const overlay = document.createElement("div");
      overlay.className = "videoFocus";

      const inner = document.createElement("div");
      inner.className = "videoFocusInner";

      const closeBtn = document.createElement("button");
      closeBtn.className = "videoFocusClose";
      closeBtn.type = "button";
      closeBtn.setAttribute("aria-label", "Video schließen");
      closeBtn.innerHTML = "&times;";

      inner.appendChild(closeBtn);
      inner.appendChild(iframe);
      overlay.appendChild(inner);

      const cleanup = () => {
        overlay.remove();
        document.body.classList.remove("isOverlayOpen");
        document.removeEventListener("keydown", onKey);
      };

      const close = () => {
        overlay.classList.remove("isOpen");
        overlay.addEventListener("transitionend", cleanup, { once: true });
        setTimeout(cleanup, 260);
      };

      const onKey = (e) => {
        if (e.key === "Escape") close();
      };

      overlay.addEventListener("click", (e) => {
        if (e.target === overlay) close();
      });

      closeBtn.addEventListener("click", close);

      document.addEventListener("keydown", onKey);
      document.body.classList.add("isOverlayOpen");
      document.body.appendChild(overlay);

      requestAnimationFrame(() => overlay.classList.add("isOpen"));
    };

    boxes.forEach((box) => {
      const btn = box.querySelector(".ytBtn");
      const posterImg = box.querySelector(".ytPoster");

      const ytId = (box.getAttribute("data-yt-id") || "").trim();
      const ytTitle = (box.getAttribute("data-yt-title") || "YouTube Video").trim();
      const poster = safeUrl(box.getAttribute("data-yt-poster") || "");

      if (posterImg && poster) {
        posterImg.src = poster;
        posterImg.alt = ytTitle + " Poster";
      }

      const showBlockedHint = () => {
        if (!btn) return;
        btn.textContent = "Zustimmen, dann laden";
        btn.disabled = true;
        btn.style.opacity = ".6";
        btn.style.cursor = "not-allowed";
      };

      const buildIframe = () => {
        if (!ytId) return null;

        const iframe = document.createElement("iframe");
        iframe.className = "ytFrame";
        iframe.title = ytTitle;
        iframe.loading = "lazy";
        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
        iframe.allowFullscreen = true;

        const params = new URLSearchParams({
          autoplay: "1",
          rel: "0",
          modestbranding: "1",
          playsinline: "1"
        });

        iframe.src = `https://www.youtube-nocookie.com/embed/${encodeURIComponent(ytId)}?${params.toString()}`;
        return iframe;
      };

      const open = () => {
        if (!consent) return;
        const iframe = buildIframe();
        if (!iframe) return;
        openVideoFocus(iframe);
      };

      if (!consent) {
        showBlockedHint();
        return;
      }

      if (btn) {
        btn.addEventListener("click", open);
      } else {
        box.addEventListener("click", open);
      }
    });
  }

  (async () => {
    initMobileMenu();

    const cc = document.getElementById("cc");
    const ccAccept = document.getElementById("ccAccept");
    const ccDecline = document.getElementById("ccDecline");
    const CC_KEY = "movemania_cookie_consent";

    const currentConsent = localStorage.getItem(CC_KEY);

    if (cc && !currentConsent) {
      cc.style.display = "block";
    }

    const applyConsentState = () => {
      const consent = localStorage.getItem(CC_KEY) === "accepted";
      initYouTubeFeedbackEmbeds(consent);
    };

    if (ccAccept) {
      ccAccept.addEventListener("click", () => {
        localStorage.setItem(CC_KEY, "accepted");
        cc.style.display = "none";
        applyConsentState();
      });
    }

    if (ccDecline) {
      ccDecline.addEventListener("click", () => {
        localStorage.setItem(CC_KEY, "declined");
        cc.style.display = "none";
        applyConsentState();
      });
    }

    applyConsentState();
    initFeedbackDetailsPlus();

    try {
      const theme = await loadJSON("assets/content/theme.json");
      applyTheme(theme);
    } catch (e) {}

    /* Logo nur anzeigen, wenn es wirklich geladen ist */
    const logo = document.getElementById("logoImg");
    if (logo) {
      if (logo.complete && logo.naturalWidth > 0) {
        logo.style.display = "block";
      } else {
        logo.addEventListener("load", () => { logo.style.display = "block"; }, { once: true });
        logo.addEventListener("error", () => { logo.style.display = "none"; }, { once: true });
      }
    }

    let links = {};
    try { links = await loadJSON("assets/content/links.json"); } catch (e) {}
    mountHeroCtas(links);

    let texts = {};
    try { texts = await loadJSON("assets/content/texts.json"); } catch (e) {}

    // Hero Text
    setText("heroBrand", (texts.hero_brand || "MOVEMANIA").toUpperCase());
    let claim = (texts.hero_title || "KINDER STÄRKEN.<br>SPIELER ENTWICKELN.").toUpperCase();
    claim = claim.replace(/^[\s\"“”„‚'«»]+|[\s\"“”„‚'«»]+$/g, "");
    setHtmlAllowBr("heroClaim", claim);
    setText("heroText", texts.hero_text || "In unseren Camps und Kursen entwickeln Kinder Freude an Bewegung – mit Struktur, Haltung und Herz.");

    // Nav / Links
    setHref("navShop", links.shop);

    setHref("kIG", links.instagram);
    setHref("kWA", links.whatsapp);

    const mailHref = normalizeMailto(links.mailto || links.email);
    if (mailHref) setHref("kMail", mailHref);

    setText("kIGText", links.instagram_text || texts.contact_ig_label || "Updates & Einblicke");
    setText("kWAText", links.whatsapp_text || texts.contact_wa_label || "Community / Infos");

    const mailVisible =
      (links.mail_text && String(links.mail_text).trim()) ||
      (links.mailto && String(links.mailto).replace(/^mailto:/i, "").trim()) ||
      (links.email && String(links.email).trim()) ||
      (texts.contact_mail_label || "Direkt schreiben");
    setText("kMailText", mailVisible);

    mountContactIcon("kMailIcon", links.mail_icon || links.contact_icon_mail, "Mail");
    mountContactIcon("kIGIcon", links.instagram_icon || links.contact_icon_instagram, "Instagram");
    mountContactIcon("kWAIcon", links.whatsapp_icon || links.contact_icon_whatsapp, "WhatsApp");

    // Über uns
    setText("aboutKicker", texts.about_kicker || "Über uns");
    setText("aboutTitle", (texts.about_title || "Wer wir sind").toUpperCase());
    setText("aboutHeadTitle", (texts.about_head_title || "Vorstellung Headcoach").toUpperCase());
    setText("aboutHeadText", texts.about_head_text || "Hier kommt eure Vorstellung (Headcoach) rein – kurz, klar, authentisch.");


    //Trust 
    
    const trustTitle = String(texts.about_trust_title || "").trim();
    const trustText  = String(texts.about_trust_text || "").trim();
    
    const trustBox = document.getElementById("aboutTrust");
      if (trustBox && (trustTitle || trustText)) {
        trustBox.style.display = "block";
        if (trustTitle) setText("aboutTrustTitle", trustTitle);
        if (trustText) setText("aboutTrustText", trustText);
      }


    // Optional: Headcoach Steckbrief (texts.json fallback)
    const headProfileFallback = String(texts.about_head_profile || texts.about_head_steckbrief || "").trim();
    if (headProfileFallback){
      const details = document.getElementById("headcoachProfile");
      const textEl = document.getElementById("headcoachProfileText");
      if (details && textEl){
        details.style.display = "block";
        setTextWithBreaks(textEl, headProfileFallback);
      }
    } else {
      const details = document.getElementById("headcoachProfile");
      if (details) details.style.display = "none";
    }

    // Werte
    setText("uspKicker", (texts.usp_kicker || "Wofür wir stehen"));
    setText("uspTitle", (texts.usp_title || "Spaß · Mut · Einsatz").toUpperCase());
    setText("uspGhost", (texts.usp_ghost || "WERTE").toUpperCase());

    // Feedback
    setText("feedbackTitle", (texts.feedback_title || "FEEDBACK").toUpperCase());
    setText("feedbackKicker", texts.feedback_kicker || "Stimmen von Eltern & Kindern");

    // News
    setText("newsTitle", (texts.news_title || "NEWS").toUpperCase());
    setText("newsKicker", texts.news_kicker || "Aktuelles & Einblicke");

    try {
      const feedbackData = await loadJSON("assets/content/feedback.json");
      mountFeedbackFromJson(feedbackData);
    } catch (e) {}

    try {
      const sponsorsData = await loadJSON("assets/content/sponsors.json");
      mountSponsors(sponsorsData);
    } catch (e) {}

    try {
      const headcoachData = await loadJSON("assets/content/headcoach.json");
      mountHeadcoachMedia(headcoachData);
      mountHeadcoachProfile(headcoachData);
    } catch (e) {}

    try {
      const coachesData = await loadJSON("assets/content/coaches.json");
      mountCoaches(coachesData);
    } catch (e) {}

    try {
      const valuesData = await loadJSON("assets/content/values.json");
      mountValues(valuesData);
    } catch (e) {}

    try {
      const offersData = await loadJSON("assets/content/offers.json");
      mountOffers(offersData);
    } catch (e) {}

    try {
      const faqData = await loadJSON("assets/content/faq.json");
      mountFaq(faqData, texts.faq_hint || "");
    } catch (e) {
      initFaq();
    }

    // HERO-Video aus hero.json (CMS)
    let heroData = null;
    try {
      heroData = await loadJSON("assets/content/hero.json");
    } catch (e) {}

    let heroSlides = null;
    if (heroData && heroData.slides) heroSlides = heroData.slides;
    else if (Array.isArray(heroData)) heroSlides = heroData;

    // Fallback nur für das Video
    if (!heroSlides) {
      heroSlides = [
        {
          type: "video",
          src: links.hero_video_mp4 || "assets/video/hero.mp4",
          poster: links.hero_video_poster || "assets/img/hero.jpg",
          title: texts.hero_slide1_title || "Vorstellung",
          text: texts.hero_slide1_text || ""
        }
      ];
    }

    heroSlides = Array.isArray(heroSlides) ? heroSlides.map((s) => ({
      type: String(s?.type || "video"),
      src: safeUrl(s?.src || ""),
      poster: safeUrl(s?.poster || ""),
      title: String(s?.title || ""),
      text: String(s?.text || "")
    })) : [];

    const firstVideo = heroSlides.find(s => String(s.type).toLowerCase() === "video") || null;

    const heroHeadline = String(texts?.hero_video_headline || "").trim();
    const heroSubline  = String(texts?.hero_subline || "").trim();
    
    if (heroHeadline) setText("heroVideoTopline", heroHeadline);
    if (heroSubline) setText("heroSubline", heroSubline);
    
    // Video mounten – ohne Headline-Overlay
    mountHeroVideo(firstVideo, { subline: heroSubline });



    // NEWS aus news.json (CMS)
    let newsData = null;
    try {
      newsData = await loadJSON("assets/content/news.json");
    } catch (e) {}

    if (newsData) {
      mountNewsFromJson(newsData);
    } else {
      // Backward-Compat: falls news.json noch nicht existiert, nutze alte hero-slides als News
      mountNewsFromSlides(heroSlides);
    }

  })();
</script>

<!-- Netlify Identity Token Catcher -->
<script>
(function () {
  const hash = window.location.hash || "";
  if (
    hash.includes("confirmation_token=") ||
    hash.includes("invite_token=") ||
    hash.includes("recovery_token=")
  ) {
    window.location.replace("/admin/" + hash);
  }
})();
</script>
