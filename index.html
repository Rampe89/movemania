<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Movemania FS – Fußballschule mit Haltung & Herz</title>
  <meta name="description" content="Movemania FS: Fußballschule (6–12) in der Region BS. Feriencamps, Trainingskurse, Ballschule. Jetzt anmelden." />

  <link rel="stylesheet" href="assets/css/fonts.css">
  <link rel="stylesheet" href="assets/css/site.css">
</head>

<body>

<header class="topbar">
  <div class="wrap">
    <div class="nav">
      <div class="brand">
        <!-- Logo: initial hidden, wird nur bei erfolgreichem Load eingeblendet (verhindert Broken-Image) -->
        <img class="logo" id="logoImg" src="assets/img/logo.png" alt="Movemania Logo" style="display:none;" />
        <div class="brandText">
          <b>Movemania</b>
          <span>Spaß. Mut. Einsatz.</span>
        </div>
      </div>

      <nav class="menu" aria-label="Hauptnavigation">
        <a href="#home" class="active">Home</a>
        <a href="#ueber-uns">Über uns</a>
        <a href="#angebote">Angebote</a>
        <a href="#feedback">Feedback</a>
        <a href="#faqs">FAQs</a>
        <a href="#kontakt">Kontakt</a>
        <a href="#" id="navShop" target="_blank" rel="noopener noreferrer">Shop</a>
      </nav>

      <div class="navCtas" aria-label="Partner & Sponsoren">
        <div class="sponsorsBar" id="sponsorsBar">
          <div class="sponsorsItems" id="sponsorsItems">
            <span class="sponsorsEmpty">Partner-Logos folgen</span>
          </div>
          <div class="sponsorsLabel" id="sponsorsLabel">Partner</div>
        </div>
      </div>
    </div>
  </div>
</header>

<main id="home" class="pattern">

  <!-- HERO -->
  <section class="hero">
    <div class="wrap heroInner">
      <div>
        <h1 class="heroTitle" id="heroTitle">
          <span class="heroBrand" id="heroBrand">MOVEMANIA</span>
          <span class="heroClaim" id="heroClaim">KINDER STÄRKEN.<br>SPIELER ENTWICKELN.</span>
        </h1>

        <p class="heroText" id="heroText">
          Inhalte laden…
        </p>
      </div>

      <!-- HERO SLIDER -->
      <div class="mediaFrame" id="heroMedia" aria-label="Hero Slider">
        <div class="slide isActive">
          <div style="height:100%;display:grid;place-items:center;color:rgba(255,255,255,.85);font-weight:800;font-size:13px;padding:18px;text-align:center;">
            Inhalte laden…
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ÜBER UNS -->
  <section id="ueber-uns" class="section">
    <div class="wrap">
      <div class="sectionHeadCenter">
        <p class="sectionKicker" id="aboutKicker">Über uns</p>
        <h2 class="sectionTitle" id="aboutTitle">WER WIR SIND</h2>
      </div>

      <div class="aboutGrid">
        <div class="aboutMedia" id="aboutMedia">
          <div style="height:100%;display:grid;place-items:center;color:rgba(11,16,32,.45);font-weight:900;letter-spacing:.18em;text-transform:uppercase;font-size:11px;">
            Bild/Video (Headcoach)
          </div>
        </div>

        <div class="card">
          <h3 id="aboutHeadTitle">VORSTELLUNG HEADCOACH</h3>
          <p id="aboutHeadText">Inhalte laden…</p>

          <!-- NEU: Headcoach Steckbrief (aufklappbar über + / Mehr) -->
          <details class="coachBio" id="headcoachProfile" style="margin-top:10px;">
            <summary class="coachBioSum" id="headcoachProfileSum">Mehr</summary>
            <p id="headcoachProfileText" style="margin-top:10px;">
              Inhalte laden…
            </p>
          </details>

          <div class="cardActions">
            <a class="btn btnGhost btnAccent" id="aboutCta" href="#kontakt">Kontakt aufnehmen</a>
          </div>
        </div>
      </div>

      <div style="margin-top:18px;">
        <div class="sectionHeadCenter" style="margin-bottom:10px;">
          <h3 style="margin:0;font-weight:900;text-transform:uppercase;letter-spacing:-.01em;font-size:var(--card-title);" id="coachTitle">
            COACHES
          </h3>
        </div>

        <div class="peopleGrid" id="coachGrid">
          <!-- Platzhalter: wird durch CMS ersetzt -->
          <div class="person">
            <div class="ph">Coach</div>
            <div class="personBody">
              <b>Vorname Nachname</b>
              <small>Rolle / Schwerpunkt</small>

              <details class="coachBio">
                <summary class="coachBioSum">Mehr</summary>
                <p>Kurzprofil / Schwerpunkt (Platzhalter).</p>
              </details>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- WOFÜR WIR STEHEN / WERTE -->
  <section id="werte" class="usp">
    <div class="wrap">
      <div class="uspHead">
        <div class="uspGhost" id="uspGhost">WERTE</div>
        <p class="uspKicker" id="uspKicker">Wofür wir stehen</p>
        <h2 class="uspTitle" id="uspTitle">SPAß · MUT · EINSATZ</h2>
      </div>

      <div class="cards" id="valuesGrid" aria-label="Werte">
        <div class="card">
          <div class="valueTop">
            <span class="valueIcon"><span style="font-weight:900;letter-spacing:.18em;font-size:11px;color:rgba(11,16,32,.55)">ICON</span></span>
            <h3>MUT</h3>
          </div>
          <p>Wir stärken Kinder, Entscheidungen zu treffen, Verantwortung zu übernehmen und sich etwas zuzutrauen.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ANGEBOTE -->
  <section id="angebote" class="section">
    <div class="wrap">
      <div class="sectionHeadCenter">
        <h2 class="sectionTitle" id="offersSectionTitle">ANGEBOTE</h2>
      </div>

      <div class="offerGrid" id="offersGrid">

        <details class="offerAcc" id="accFeriencamps">
          <summary>
            <span class="offerAccTitle" id="offersFeriencampsTitle">Feriencamps</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersFeriencampsMedia" aria-hidden="true"></div>
            <p id="offersFeriencampsText">Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.</p>
            <div class="subOffers" id="offersFeriencampsSubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accElitecamps">
          <summary>
            <span class="offerAccTitle" id="offersElitecampsTitle">Elitecamps</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersElitecampsMedia" aria-hidden="true"></div>
            <p id="offersElitecampsText">Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.</p>
            <div class="subOffers" id="offersElitecampsSubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accPowerkurse">
          <summary>
            <span class="offerAccTitle" id="offersPowerkurseTitle">Powerkurse</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersPowerkurseMedia" aria-hidden="true"></div>
            <p id="offersPowerkurseText">Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.</p>
            <div class="subOffers" id="offersPowerkurseSubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accElitekurs">
          <summary>
            <span class="offerAccTitle" id="offersElitekursTitle">Elitekurse</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersElitekursMedia" aria-hidden="true"></div>
            <p id="offersElitekursText">Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.</p>
            <div class="subOffers" id="offersElitekursSubs"></div>
          </div>
        </details>

        <!-- NEU: Reihenfolge geändert: Athletik + Spielnah direkt nach Elitekurse und vor Ballschule -->

        <details class="offerAcc" id="accAthletik">
          <summary>
            <span class="offerAccTitle" id="offersAthletikTitle">Athletiktraining</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersAthletikMedia" aria-hidden="true"></div>
            <p id="offersAthletikText">Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.</p>
            <div class="subOffers" id="offersAthletikSubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accSpielnahIndi">
          <summary>
            <span class="offerAccTitle" id="offersSpielnahIndiTitle">Spielnahes Individualtraining</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersSpielnahIndiMedia" aria-hidden="true"></div>
            <p id="offersSpielnahIndiText">Inhalte folgen (CMS). Optional: Bild, Text, Link und Unterpunkte.</p>
            <div class="subOffers" id="offersSpielnahIndiSubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accBalls">
          <summary>
            <span class="offerAccTitle" id="offersBallsTitle">Ballschule</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersBallsMedia" aria-hidden="true"></div>
            <p id="offersBallsText">Motorik, Ballgefühl, Koordination – ideal als Fundament (z. B. für Einsteiger).</p>
            <div class="subOffers" id="offersBallsSubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accKiga">
          <summary>
            <span class="offerAccTitle" id="offersKigaTitle">Fußballkindergarten</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersKigaMedia" aria-hidden="true"></div>
            <p id="offersKigaText">Spielerisches Training für die Kleineren – Bewegung, Spaß und erste Fußball-Basics.</p>
            <div class="subOffers" id="offersKigaSubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accGeburtstage">
          <summary>
            <span class="offerAccTitle" id="offersBdayTitle">Kindergeburtstage</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersBdayMedia" aria-hidden="true"></div>
            <p id="offersBdayText">Bewegung, Spiele, Fußball-Action – ein Geburtstag, an den sich Kinder gerne erinnern.</p>
            <div class="subOffers" id="offersBdaySubs"></div>
          </div>
        </details>

        <details class="offerAcc" id="accBeratung">
          <summary>
            <span class="offerAccTitle" id="offersBeratungTitle">Beratung</span>
            <i class="offerAccIcon">+</i>
          </summary>
          <div class="offerAccBody">
            <div class="offerMedia" id="offersBeratungMedia" aria-hidden="true"></div>
            <p id="offersBeratungText">Unterstützung für Vereine, Trainer und Teams – von Konzept bis Fortbildung.</p>
            <div class="subOffers" id="offersBeratungSubs"></div>
          </div>
        </details>

      </div>
    </div>
  </section>

  <!-- FEEDBACK -->
  <section id="feedback" class="section">
    <div class="wrap">
      <div class="sectionHeadCenter">
        <h2 class="sectionTitle" id="feedbackTitle">FEEDBACK</h2>
        <p class="sectionKicker" id="feedbackKicker">Stimmen von Eltern & Kindern</p>
      </div>

      <div class="stackWrap">

        <!-- 1) FIXE VIDEOS (Code) -->
        <div class="sectionHeadCenter" style="margin-bottom:12px;">
          <h3 style="margin:0;font-weight:900;text-transform:uppercase;letter-spacing:-.01em;font-size:var(--card-title);">
            VIDEO-FEEDBACK
          </h3>
        </div>

        <div class="feedbackGrid" id="videoGrid" aria-label="Video Feedback">
          <div class="card">
            <div class="ytBox"
                 data-yt-id="g8B38aVhbEk"
                 data-yt-title="Feedback Video 1"
                 data-yt-poster="assets/img/feedback-1.jpg">
              <img class="ytPoster" src="assets/img/feedback-1.jpg" alt="Feedback Video 1 Poster" loading="lazy">
              <div class="ytOverlay">
                <div class="ytOverlayInner">
                  <div class="ytHint">YouTube-Video<br>(lädt erst nach Klick)</div>
                  <button class="ytBtn" type="button">Video laden</button>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="ytBox"
                 data-yt-id="VIDEO_ID_2"
                 data-yt-title="Feedback Video 2"
                 data-yt-poster="assets/img/feedback-2.jpg">
              <img class="ytPoster" src="assets/img/feedback-2.jpg" alt="Feedback Video 2 Poster" loading="lazy">
              <div class="ytOverlay">
                <div class="ytOverlayInner">
                  <div class="ytHint">YouTube-Video<br>(lädt erst nach Klick)</div>
                  <button class="ytBtn" type="button">Video laden</button>
                </div>
              </div>
            </div>
          </div>

          <div class="card">
            <div class="ytBox"
                 data-yt-id="VIDEO_ID_3"
                 data-yt-title="Feedback Video 3"
                 data-yt-poster="assets/img/feedback-3.jpg">
              <img class="ytPoster" src="assets/img/feedback-3.jpg" alt="Feedback Video 3 Poster" loading="lazy">
              <div class="ytOverlay">
                <div class="ytOverlayInner">
                  <div class="ytHint">YouTube-Video<br>(lädt erst nach Klick)</div>
                  <button class="ytBtn" type="button">Video laden</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 2) CMS-FEEDBACK (Texts/Names/etc.) -->
        <div class="sectionHeadCenter" style="margin:22px 0 12px;">
          <h3 style="margin:0;font-weight:900;text-transform:uppercase;letter-spacing:-.01em;font-size:var(--card-title);">
            TEXT-FEEDBACK
          </h3>
        </div>

        <div class="feedbackGrid" id="feedbackGrid" aria-label="Feedback Texte">
          <div class="card">
            <div class="fbMedia" id="fb1Poster" aria-hidden="true"></div>
            <div class="fbMedia" id="fb1Image" aria-hidden="true"></div>

            <h3 id="fb1Title">FEEDBACK 1</h3>
            <p id="fb1Name" style="margin:-4px 0 10px;color:rgba(11,16,32,.55);font-weight:900;letter-spacing:.10em;text-transform:uppercase;font-size:11px;">
              —
            </p>

            <!-- NEU: Text aufklappbar über + -->
            <details class="coachBio fbDetails" id="fb1Details">
              <summary class="coachBioSum fbSum">Mehr <span class="fbPlus" aria-hidden="true">+</span></summary>
              <p id="fb1Text">Kurzer Text/Einordnung (optional). Zum Beispiel: „Tolles Training, super Stimmung.“</p>
            </details>
          </div>

          <div class="card">
            <div class="fbMedia" id="fb2Poster" aria-hidden="true"></div>
            <div class="fbMedia" id="fb2Image" aria-hidden="true"></div>

            <h3 id="fb2Title">FEEDBACK 2</h3>
            <p id="fb2Name" style="margin:-4px 0 10px;color:rgba(11,16,32,.55);font-weight:900;letter-spacing:.10em;text-transform:uppercase;font-size:11px;">
              —
            </p>

            <details class="coachBio fbDetails" id="fb2Details">
              <summary class="coachBioSum fbSum">Mehr <span class="fbPlus" aria-hidden="true">+</span></summary>
              <p id="fb2Text">Kurzer Text/Einordnung (optional). Zum Beispiel: „Unser Kind kommt begeistert nach Hause.“</p>
            </details>
          </div>

          <div class="card">
            <div class="fbMedia" id="fb3Poster" aria-hidden="true"></div>
            <div class="fbMedia" id="fb3Image" aria-hidden="true"></div>

            <h3 id="fb3Title">FEEDBACK 3</h3>
            <p id="fb3Name" style="margin:-4px 0 10px;color:rgba(11,16,32,.55);font-weight:900;letter-spacing:.10em;text-transform:uppercase;font-size:11px;">
              —
            </p>

            <details class="coachBio fbDetails" id="fb3Details">
              <summary class="coachBioSum fbSum">Mehr <span class="fbPlus" aria-hidden="true">+</span></summary>
              <p id="fb3Text">Kurzer Text/Einordnung (optional). Zum Beispiel: „Strukturiert, wertschätzend, klasse Coaches.“</p>
            </details>
          </div>

          <div class="card">
            <div class="fbMedia" id="fb4Poster" aria-hidden="true"></div>
            <div class="fbMedia" id="fb4Image" aria-hidden="true"></div>

            <h3 id="fb4Title">FEEDBACK 4</h3>
            <p id="fb4Name" style="margin:-4px 0 10px;color:rgba(11,16,32,.55);font-weight:900;letter-spacing:.10em;text-transform:uppercase;font-size:11px;">
              —
            </p>

            <details class="coachBio fbDetails" id="fb4Details">
              <summary class="coachBioSum fbSum">Mehr <span class="fbPlus" aria-hidden="true">+</span></summary>
              <p id="fb4Text">Kurzer Text/Einordnung (optional). Zum Beispiel: „Strukturiert, wertschätzend, klasse Coaches.“</p>
            </details>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- FAQS -->
  <section id="faqs" class="section">
    <div class="wrap">
      <div class="sectionHeadCenter">
        <h2 class="sectionTitle" id="faqTitle">FAQs</h2>
      </div>

      <div class="stackWrap">
        <div class="faq" id="faqBox">
          <div class="faqItem">
            <button class="faqQ" type="button"><span>1. Frage (Platzhalter)</span><i>+</i></button>
            <div class="faqA">Antworttext (Platzhalter). Kann später aus dem CMS geladen werden.</div>
          </div>
        </div>

        <p style="margin:14px 0 0;color:rgba(11,16,32,.55);font-size:12px;line-height:1.7;text-align:center;" id="faqHint">
          Hast du weitere Fragen? Dann nimm Kontakt per E-Mail auf.
        </p>
      </div>
    </div>
  </section>

  <!-- KONTAKT -->
  <section id="kontakt" class="section">
    <div class="wrap">
      <div class="sectionHeadCenter">
        <h2 class="sectionTitle">KONTAKT</h2>
      </div>

      <div class="kontaktGrid">
        <a class="kontaktCard" id="kMail" href="#" rel="noreferrer">
          <div>
            <b>E-Mail</b>
            <small id="kMailText">Direkt schreiben</small>
          </div>
          <div class="kontaktIcon" id="kMailIcon"><span id="kMailIconFallback">MAIL</span></div>
        </a>

        <a class="kontaktCard" id="kIG" href="#" target="_blank" rel="noopener noreferrer">
          <div>
            <b>Instagram</b>
            <small id="kIGText">Updates & Einblicke</small>
          </div>
          <div class="kontaktIcon" id="kIGIcon"><span id="kIGIconFallback">IG</span></div>
        </a>

        <a class="kontaktCard" id="kWA" href="#" target="_blank" rel="noopener noreferrer">
          <div>
            <b>WhatsApp</b>
            <small id="kWAText">Community / Infos</small>
          </div>
          <div class="kontaktIcon" id="kWAIcon"><span id="kWAIconFallback">WA</span></div>
        </a>
      </div>
    </div>
  </section>

</main>

<footer>
  <div class="wrap">
    <b style="color:var(--ink)">Movemania FS</b><br>
    Fußballschule mit Haltung &amp; Herz

    <div style="margin-top:12px; display:flex; gap:12px; flex-wrap:wrap;">
      <a class="btn btnGhost" href="/impressum.html">Impressum</a>
      <a class="btn btnGhost" href="/datenschutz.html">Datenschutz</a>
      <a class="btn btnGhost" href="/agbs.html">AGBs</a>
    </div>
  </div>
</footer>

<!-- Cookie Opt-in -->
<div class="cc" id="cc">
  <h4>Cookie-Einstellungen</h4>
  <p>
    Wir verwenden keine Tracking- oder Marketing-Cookies.
    Technisch notwendige Speicherungen erfolgen nur mit Ihrer Zustimmung.
    YouTube-Videos werden erst nach Zustimmung und Klick geladen.
  </p>

  <div class="ccActions">
    <button class="btn btnBlue" id="ccAccept" type="button">
      Akzeptieren
    </button>
    <button class="btn btnGhost" id="ccDecline" type="button">
      Ablehnen
    </button>
  </div>

  <small>
    Weitere Informationen finden Sie in der
    <a href="/datenschutz.html">Datenschutzerklärung</a>.
  </small>
</div>

<script>
  async function loadJSON(path){
    const res = await fetch(path, { cache: "no-store" });
    if (!res.ok) throw new Error("Failed to load " + path + " (" + res.status + ")");
    return await res.json();
  }

  /* ---------------------------
     Security/Hardening Helpers
     --------------------------- */

  function isSafeUrl(url){
    const s = String(url || "").trim();
    if (!s) return false;
    // block javascript:, data: (optional), vbscript:
    if (/^\s*(javascript|vbscript):/i.test(s)) return false;
    // allow http(s), protocol-relative, mailto, tel, and relative paths
    if (/^(https?:|mailto:|tel:|\/|\.\/|\.\.\/)/i.test(s)) return true;
    // also allow plain anchors like #kontakt
    if (/^#/.test(s)) return true;
    return false;
  }

  function safeUrl(url){
    return isSafeUrl(url) ? String(url).trim() : "";
  }

  function clearEl(el){
    if (!el) return;
    while (el.firstChild) el.removeChild(el.firstChild);
  }

  function setHref(id, url){
    const el = document.getElementById(id);
    const u = safeUrl(url);
    if (el && u) el.href = u;
  }

  function setText(id, value){
    const el = document.getElementById(id);
    if (!el || value === undefined || value === null) return;
    const v = String(value).trim();
    if (!v) return;
    el.textContent = v;
  }

  // erlaubt nur <br>, entfernt alle anderen Tags (wie vorher), setzt dann innerHTML bewusst
  function setHtmlAllowBr(id, value){
    const el = document.getElementById(id);
    if (!el || value === undefined || value === null) return;
    const raw = String(value).trim();
    if (!raw) return;

    const BR = "__BR__";
    let v = raw.replace(/<\s*br\s*\/?\s*>/gi, BR);
    v = v.replace(/<[^>]*>/g, "");
    v = v.replace(new RegExp(BR, "g"), "<br>");
    el.innerHTML = v;
  }

  function normalizeMailto(input){
    if (!input) return "";
    const raw = String(input).trim();
    if (!raw) return "";
    if (/^mailto:/i.test(raw)) return raw;
    if (raw.includes("@")) return "mailto:" + raw;
    return raw;
  }

  function mountOptionalImage(containerId, src, alt){
    const el = document.getElementById(containerId);
    if (!el) return;
    const s = safeUrl(src);
    if (!s) return;

    clearEl(el);
    const img = document.createElement("img");
    img.src = s;
    img.alt = (alt || "").toString().trim() || "Bild";
    img.loading = "lazy";
    el.appendChild(img);
    el.style.display = "block";
  }

  function mountContactIcon(containerId, src, alt){
    const el = document.getElementById(containerId);
    if (!el) return;
    const s = safeUrl(src);
    if (!s) return;

    clearEl(el);
    const img = document.createElement("img");
    img.src = s;
    img.alt = (alt || "").toString().trim() || "Icon";
    img.loading = "lazy";
    el.appendChild(img);
  }

  function applyTheme(theme){
    const root = document.documentElement;
    const setVar = (k, v) => {
      if (v === undefined || v === null || v === "") return;
      root.style.setProperty(k, v);
    };

    const colors = theme?.colors || {};
    const type = theme?.type || {};
    const layout = theme?.layout || {};
    const pattern = theme?.pattern || {};

    setVar("--bg", colors.bg);
    setVar("--ink", colors.ink);
    setVar("--muted", colors.muted);
    setVar("--line", colors.line);

    setVar("--navy", colors.primary);
    setVar("--red", colors.accent);

    setVar("--card-bg", colors.card_bg);
    setVar("--card-border", colors.card_border);

    if (typeof type.body_size === "number") setVar("--base", type.body_size + "px");
    if (typeof type.hero_title_size === "number") setVar("--hero-title-max", type.hero_title_size + "px");
    if (typeof type.section_title_size === "number") setVar("--section-title", type.section_title_size + "px");
    if (typeof type.card_title_size === "number") setVar("--card-title", type.card_title_size + "px");

    if (typeof layout.content_width === "number") setVar("--max", layout.content_width + "px");
    if (typeof layout.radius === "number") setVar("--radius", layout.radius + "px");
    if (typeof layout.shadow_strength === "number") {
      const s = Math.max(0, Math.min(0.3, layout.shadow_strength));
      setVar("--shadow", `0 14px 40px rgba(11,16,32,${s})`);
    }

    if (pattern.enabled === false) {
      setVar("--patternOpacity", "0");
    } else {
      if (typeof pattern.opacity === "number") setVar("--patternOpacity", String(pattern.opacity));
      if (pattern.dot) setVar("--patternDot", pattern.dot);
      if (typeof pattern.size === "number") setVar("--patternSize", pattern.size + "px");
    }
  }

  /* HERO Slider (hardened: no untrusted innerHTML) */
  function mountHeroSlider(slides){
    const heroMedia = document.getElementById("heroMedia");
    if (!heroMedia) return;

    const safeSlides = Array.isArray(slides) && slides.length ? slides : [
      {
        type: "video",
        src: "assets/video/hero.mp4",
        poster: "assets/img/hero.jpg",
        title: "Vorstellung",
        text: "Hier steht später die Vorstellung / kurze Einordnung (aus dem CMS)."
      },
      { type: "image", src: "assets/img/placeholder-1.jpg", title: "Wofür wir stehen", text: "Werte, Haltung, Herz – kurz und klar." },
      { type: "image", src: "assets/img/placeholder-2.jpg", title: "Was wir machen", text: "Camps, Kurse, Ballschule – Überblick." }
    ];

    let idx = 0;
    let timer = null;
    let soundOn = false;

    const stop = () => { if (timer) clearTimeout(timer); timer = null; };

    const slideDelayMs = () => {
      const s = safeSlides[idx] || {};
      if (s.type === "video") return 66000;
      return 6500;
    };

    const restart = () => {
      stop();
      timer = setTimeout(() => {
        idx = (idx + 1) % safeSlides.length;
        render();
        restart();
      }, slideDelayMs());
    };

    const applySoundToActiveVideo = () => {
      const activeSlide = heroMedia.querySelector(".slide.isActive");
      if (!activeSlide) return;

      heroMedia.querySelectorAll("video").forEach((v) => {
        const isInActive = v.closest(".slide") === activeSlide;
        if (!isInActive) {
          try { v.pause(); } catch (e) {}
          v.muted = true;
          v.volume = 1.0;
          try { v.currentTime = 0; } catch (e) {}
        }
      });

      const v = activeSlide.querySelector("video");
      if (!v) return;
      v.muted = !soundOn;
      v.volume = 1.0;
      v.play().catch(() => {});
    };

    const toggleSound = () => {
      soundOn = !soundOn;
      applySoundToActiveVideo();
      const btn = heroMedia.querySelector("#sSound");
      if (btn) btn.textContent = soundOn ? "Sound: An" : "Sound: Aus";
    };

    const buildOverlay = (title, text) => {
      const overlay = document.createElement("div");
      overlay.className = "slideOverlay";

      const b = document.createElement("b");
      b.textContent = String(title || "").toUpperCase();
      overlay.appendChild(b);

      const p = document.createElement("p");
      p.textContent = String(text || "");
      overlay.appendChild(p);

      return overlay;
    };

    const render = () => {
      clearEl(heroMedia);

      safeSlides.forEach((s, i) => {
        const slide = document.createElement("div");
        slide.className = "slide" + (i === idx ? " isActive" : "");

        const type = String(s?.type || "image").toLowerCase();
        if (type === "video") {
          const isActive = i === idx;
          const video = document.createElement("video");
          video.autoplay = true;
          video.loop = true;
          video.playsInline = true;
          video.preload = "metadata";

          video.muted = (!soundOn || !isActive);
          const poster = safeUrl(s?.poster || "");
          if (poster) video.poster = poster;

          const source = document.createElement("source");
          const src = safeUrl(s?.src || "");
          source.src = src || "";
          source.type = "video/mp4";
          video.appendChild(source);

          slide.appendChild(video);
          slide.appendChild(buildOverlay(s?.title, s?.text));
        } else {
          const img = document.createElement("img");
          img.src = safeUrl(s?.src || "") || "";
          img.alt = String(s?.title || "Slide");
          slide.appendChild(img);
          slide.appendChild(buildOverlay(s?.title, s?.text));
        }

        heroMedia.appendChild(slide);
      });

      const ui = document.createElement("div");
      ui.className = "sliderUi";

      const prev = document.createElement("button");
      prev.className = "vBtn";
      prev.id = "sPrev";
      prev.type = "button";
      prev.textContent = "Zurück";

      const sound = document.createElement("button");
      sound.className = "soundBtn";
      sound.id = "sSound";
      sound.type = "button";
      sound.textContent = soundOn ? "Sound: An" : "Sound: Aus";

      const next = document.createElement("button");
      next.className = "vBtn";
      next.id = "sNext";
      next.type = "button";
      next.textContent = "Weiter";

      ui.appendChild(prev);
      ui.appendChild(sound);
      ui.appendChild(next);
      heroMedia.appendChild(ui);

      const dots = document.createElement("div");
      dots.className = "dots";

      safeSlides.forEach((_, i) => {
        const d = document.createElement("button");
        d.type = "button";
        d.className = "dot" + (i === idx ? " isActive" : "");
        d.setAttribute("aria-label", "Slide " + (i + 1));
        d.addEventListener("click", () => { idx = i; render(); restart(); });
        dots.appendChild(d);
      });

      heroMedia.appendChild(dots);

      prev.addEventListener("click", () => { idx = (idx - 1 + safeSlides.length) % safeSlides.length; render(); restart(); });
      next.addEventListener("click", () => { idx = (idx + 1) % safeSlides.length; render(); restart(); });
      sound.addEventListener("click", () => { toggleSound(); });

      applySoundToActiveVideo();
    };

    heroMedia.addEventListener("mouseenter", stop);
    heroMedia.addEventListener("mouseleave", restart);

    render();
    restart();
  };

  function initFaq(){
    const box = document.getElementById("faqBox");
    if (!box) return;
    box.querySelectorAll(".faqItem").forEach((item) => {
      const btn = item.querySelector(".faqQ");
      const icon = btn ? btn.querySelector("i") : null;
      if (!btn) return;

      btn.addEventListener("click", () => {
        const isOpen = item.classList.toggle("isOpen");
        if (icon) icon.textContent = isOpen ? "–" : "+";
      });
    });
  }

  function initFeedbackDetailsPlus(){
    document.querySelectorAll("details.fbDetails").forEach((d) => {
      const plus = d.querySelector(".fbPlus");
      const sync = () => { if (plus) plus.textContent = d.open ? "–" : "+"; };
      sync();
      d.addEventListener("toggle", sync);
    });
  }

  function mountHeadcoachMedia(data){
    const el = document.getElementById("aboutMedia");
    if (!el) return;

    const img = data?.image ? safeUrl(data.image) : "";
    const vid = data?.video ? safeUrl(data.video) : "";
    const poster = data?.poster ? safeUrl(data.poster) : "";

    clearEl(el);

    if (vid){
      const video = document.createElement("video");
      video.controls = true;
      video.playsInline = true;
      video.preload = "metadata";
      if (poster) video.poster = poster;

      const source = document.createElement("source");
      source.src = vid;
      source.type = "video/mp4";
      video.appendChild(source);

      el.appendChild(video);
      return;
    }

    if (img){
      const image = document.createElement("img");
      image.src = img;
      image.alt = "Headcoach";
      image.loading = "lazy";
      el.appendChild(image);
      return;
    }

    const ph = document.createElement("div");
    ph.style.height = "100%";
    ph.style.display = "grid";
    ph.style.placeItems = "center";
    ph.style.color = "rgba(11,16,32,.45)";
    ph.style.fontWeight = "900";
    ph.style.letterSpacing = ".18em";
    ph.style.textTransform = "uppercase";
    ph.style.fontSize = "11px";
    ph.textContent = "Bild/Video (Headcoach)";
    el.appendChild(ph);
  }

  function mountHeadcoachProfile(data){
    // Erwartet in headcoach.json optional: profile (Steckbrief-Text) oder bio
    const details = document.getElementById("headcoachProfile");
    const textEl = document.getElementById("headcoachProfileText");
    if (!details || !textEl) return;

    const profile = String(data?.profile || data?.bio || "").trim();
    if (!profile) {
      details.style.display = "none";
      return;
    }
    details.style.display = "block";
    textEl.textContent = profile;
  }

  function mountCoaches(data){
    const grid = document.getElementById("coachGrid");
    if (!grid) return;

    const itemsRaw = Array.isArray(data?.coaches) ? data.coaches : [];
    if (!itemsRaw.length) return;

    // NEU: Reihenfolge über CMS steuerbar
    // - supported: c.order (number), oder c.sort (number)
    // - fallback: name alphabetisch
    const items = itemsRaw
      .slice(0, 50)
      .map((c) => ({
        ...c,
        _order: (typeof c?.order === "number" ? c.order : (typeof c?.sort === "number" ? c.sort : null))
      }))
      .sort((a, b) => {
        const ao = a._order, bo = b._order;
        if (ao !== null && bo !== null) return ao - bo;
        if (ao !== null) return -1;
        if (bo !== null) return 1;
        const an = String(a?.name || "").toLowerCase();
        const bn = String(b?.name || "").toLowerCase();
        return an.localeCompare(bn, "de");
      });

    clearEl(grid);

    items.slice(0, 12).forEach((c) => {
      const name = String(c?.name || "Coach");
      const role = String(c?.role || "").trim();
      const bio = String(c?.bio || "").trim();
      const imageUrl = safeUrl(c?.image || "");

      const card = document.createElement("div");
      card.className = "person";

      if (imageUrl){
        const img = document.createElement("img");
        img.src = imageUrl;
        img.alt = name;
        img.loading = "lazy";
        card.appendChild(img);
      } else {
        const ph = document.createElement("div");
        ph.className = "ph";
        ph.textContent = "Coach";
        card.appendChild(ph);
      }

      const body = document.createElement("div");
      body.className = "personBody";

      const b = document.createElement("b");
      b.textContent = name.toUpperCase();
      body.appendChild(b);

      if (role){
        const small = document.createElement("small");
        small.textContent = role;
        body.appendChild(small);
      }

      if (bio){
        const details = document.createElement("details");
        details.className = "coachBio";

        const sum = document.createElement("summary");
        sum.className = "coachBioSum";
        sum.textContent = "Mehr";
        details.appendChild(sum);

        const p = document.createElement("p");
        p.textContent = bio;
        details.appendChild(p);

        body.appendChild(details);
      }

      card.appendChild(body);
      grid.appendChild(card);
    });
  }

  function mountSponsors(data){
    const label = document.getElementById("sponsorsLabel");
    const itemsEl = document.getElementById("sponsorsItems");
    if (!itemsEl) return;

    const title = data && (data.title || data.label);
    if (label && title) label.textContent = String(title);

    const items = Array.isArray(data?.items) ? data.items
                : Array.isArray(data?.sponsors) ? data.sponsors
                : Array.isArray(data) ? data
                : [];

    if (!items.length) return;

    clearEl(itemsEl);

    const withLogo = items.filter((it) => it && it.logo && safeUrl(it.logo));
    if (!withLogo.length) {
      const sp = document.createElement("span");
      sp.className = "sponsorsEmpty";
      sp.textContent = "Partner-Logos folgen";
      itemsEl.appendChild(sp);
      return;
    }

    withLogo.slice(0, 12).forEach((it) => {
      const name = String(it?.name || "Partner");
      const url = safeUrl(it?.url || "");
      const logo = safeUrl(it?.logo || "");
      if (!logo) return;

      const wrapper = document.createElement(url ? "a" : "span");
      wrapper.className = "sponsorLink";

      if (url){
        wrapper.href = url;
        wrapper.target = "_blank";
        wrapper.rel = "noopener noreferrer";
      }

      const img = document.createElement("img");
      img.src = logo;
      img.alt = name || "Partner";
      img.loading = "lazy";
      wrapper.appendChild(img);

      itemsEl.appendChild(wrapper);
    });
  }

  function mountValues(valuesData){
    const defaultValues = [
      { title: "Mut", text: "Wir stärken Kinder, Entscheidungen zu treffen, Verantwortung zu übernehmen und sich etwas zuzutrauen.", icon: "assets/img/icons/mut.svg" },
      { title: "Einsatz", text: "Leistung entsteht durch Freude am Training, Dranbleiben und gemeinsames Arbeiten an Zielen.", icon: "assets/img/icons/einsatz.svg" },
      { title: "Respekt", text: "Respekt, Fairness und ein positives Miteinander sind bei uns nicht verhandelbar.", icon: "assets/img/icons/respekt.svg" }
    ];

    const values =
      (Array.isArray(valuesData?.items) && valuesData.items.length ? valuesData.items :
      (Array.isArray(valuesData?.values) && valuesData.values.length ? valuesData.values :
      defaultValues));

    const grid = document.getElementById("valuesGrid");
    if (!grid) return;

    clearEl(grid);

    values.slice(0, 6).forEach((v) => {
      const card = document.createElement("div");
      card.className = "card";

      const top = document.createElement("div");
      top.className = "valueTop";

      const iconWrap = document.createElement("span");
      iconWrap.className = "valueIcon";

      const iconUrl = safeUrl(v?.icon || "");
      if (iconUrl){
        const img = document.createElement("img");
        img.src = iconUrl;
        img.alt = String(v?.icon_alt || v?.title || "Icon");
        img.loading = "lazy";
        iconWrap.appendChild(img);
      }

      const h3 = document.createElement("h3");
      h3.textContent = String(v?.title || "").toUpperCase();

      top.appendChild(iconWrap);
      top.appendChild(h3);

      const p = document.createElement("p");
      p.textContent = String(v?.text || "");

      card.appendChild(top);
      card.appendChild(p);

      grid.appendChild(card);
    });
  }

  function mountOffers(offersData){
    const offers = offersData?.offers || offersData || {};

    const addOptionalLinkButton = (containerEl, link, label, cssClass) => {
      if (!containerEl) return;
      const href = safeUrl(link);
      if (!href) return;

      const a = document.createElement("a");
      a.className = (cssClass || "btn btnGhost") + " btnAccent";
      a.href = href;
      a.target = "_blank";
      a.rel = "noopener noreferrer";
      a.textContent = String(label || "Mehr").toUpperCase();

      const wrap = document.createElement("div");
      wrap.className = "cardActions";
      wrap.appendChild(a);
      containerEl.appendChild(wrap);
    };

    const renderSubs = (subsElId, subs) => {
      const el = document.getElementById(subsElId);
      if (!el) return;
      const list = Array.isArray(subs) ? subs : [];
      if (!list.length) return;

      clearEl(el);

      list.slice(0, 6).forEach((s) => {
        const div = document.createElement("div");
        div.className = "subCard";

        const b = document.createElement("b");
        b.textContent = String(s?.title || "Unterpunkt");
        div.appendChild(b);

        const small = document.createElement("small");
        small.textContent = String(s?.text || "");
        div.appendChild(small);

        const link = safeUrl(s?.link || "");
        if (link){
          const mt = document.createElement("div");
          mt.style.marginTop = "8px";

          const a = document.createElement("a");
          a.className = "btn btnGhost btnAccent";
          a.href = link;
          a.target = "_blank";
          a.rel = "noopener noreferrer";
          a.textContent = String(s?.link_label || "Mehr").toUpperCase();

          mt.appendChild(a);
          div.appendChild(mt);
        }

        el.appendChild(div);
      });
    };

    if (offers?.feriencamps){
      setText("offersFeriencampsTitle", offers.feriencamps.title || "Feriencamps");
      setText("offersFeriencampsText", offers.feriencamps.text);
      mountOptionalImage("offersFeriencampsMedia", offers.feriencamps.image, offers.feriencamps.title || "Feriencamps");
      const body = document.querySelector("#accFeriencamps .offerAccBody");
      addOptionalLinkButton(body, offers.feriencamps.link, offers.feriencamps.link_label, "btn btnGhost");
      renderSubs("offersFeriencampsSubs", offers.feriencamps.sub);
    }

    if (offers?.elitecamps){
      setText("offersElitecampsTitle", offers.elitecamps.title || "Elitecamps");
      setText("offersElitecampsText", offers.elitecamps.text);
      mountOptionalImage("offersElitecampsMedia", offers.elitecamps.image, offers.elitecamps.title || "Elitecamps");
      const body = document.querySelector("#accElitecamps .offerAccBody");
      addOptionalLinkButton(body, offers.elitecamps.link, offers.elitecamps.link_label, "btn btnGhost");
      renderSubs("offersElitecampsSubs", offers.elitecamps.sub);
    }

    if (offers?.powerkurse){
      setText("offersPowerkurseTitle", offers.powerkurse.title || "Powerkurse");
      setText("offersPowerkurseText", offers.powerkurse.text);
      mountOptionalImage("offersPowerkurseMedia", offers.powerkurse.image, offers.powerkurse.title || "Powerkurse");
      const body = document.querySelector("#accPowerkurse .offerAccBody");
      addOptionalLinkButton(body, offers.powerkurse.link, offers.powerkurse.link_label, "btn btnGhost");
      renderSubs("offersPowerkurseSubs", offers.powerkurse.sub);
    }

    if (offers?.elitekurse){
      setText("offersElitekursTitle", offers.elitekurse.title || "Elitekurse");
      setText("offersElitekursText", offers.elitekurse.text);
      mountOptionalImage("offersElitekursMedia", offers.elitekurse.image, offers.elitekurse.title || "Elitekurse");
      const body = document.querySelector("#accElitekurs .offerAccBody");
      addOptionalLinkButton(body, offers.elitekurse.link, offers.elitekurse.link_label, "btn btnGhost");
      renderSubs("offersElitekursSubs", offers.elitekurse.sub);
    }

    if (offers?.athletik){
      setText("offersAthletikTitle", offers.athletik.title || "Athletiktraining");
      setText("offersAthletikText", offers.athletik.text);
      mountOptionalImage("offersAthletikMedia", offers.athletik.image, offers.athletik.title || "Athletiktraining");
      const body = document.querySelector("#accAthletik .offerAccBody");
      addOptionalLinkButton(body, offers.athletik.link, offers.athletik.link_label || "Mehr", "btn btnGhost");
      renderSubs("offersAthletikSubs", offers.athletik.sub);
    }

    if (offers?.spielnah_individual){
      setText("offersSpielnahIndiTitle", offers.spielnah_individual.title || "Spielnahes Individualtraining");
      setText("offersSpielnahIndiText", offers.spielnah_individual.text);
      mountOptionalImage("offersSpielnahIndiMedia", offers.spielnah_individual.image, offers.spielnah_individual.title || "Spielnahes Individualtraining");
      const body = document.querySelector("#accSpielnahIndi .offerAccBody");
      addOptionalLinkButton(body, offers.spielnah_individual.link, offers.spielnah_individual.link_label || "Mehr", "btn btnGhost");
      renderSubs("offersSpielnahIndiSubs", offers.spielnah_individual.sub);
    }

    if (offers?.ballschule){
      setText("offersBallsTitle", offers.ballschule.title || "Ballschule");
      setText("offersBallsText", offers.ballschule.text);
      mountOptionalImage("offersBallsMedia", offers.ballschule.image, offers.ballschule.title || "Ballschule");
      const body = document.querySelector("#accBalls .offerAccBody");
      addOptionalLinkButton(body, offers.ballschule.link, offers.ballschule.link_label || "Zur Anmeldung", "btn btnGhost");
      renderSubs("offersBallsSubs", offers.ballschule.sub);
    }

    if (offers?.kiga){
      setText("offersKigaTitle", offers.kiga.title || "Fußballkindergarten");
      setText("offersKigaText", offers.kiga.text);
      mountOptionalImage("offersKigaMedia", offers.kiga.image, offers.kiga.title || "Fußballkindergarten");
      const body = document.querySelector("#accKiga .offerAccBody");
      addOptionalLinkButton(body, offers.kiga.link, offers.kiga.link_label || "Zur Anmeldung", "btn btnGhost");
      renderSubs("offersKigaSubs", offers.kiga.sub);
    }

    if (offers?.geburtstage){
      setText("offersBdayTitle", offers.geburtstage.title || "Kindergeburtstage");
      setText("offersBdayText", offers.geburtstage.text);
      mountOptionalImage("offersBdayMedia", offers.geburtstage.image, offers.geburtstage.title || "Kindergeburtstage");
      const body = document.querySelector("#accGeburtstage .offerAccBody");
      addOptionalLinkButton(body, offers.geburtstage.link, offers.geburtstage.link_label || "Zur Anfrage", "btn btnGhost");
      renderSubs("offersBdaySubs", offers.geburtstage.sub);
    }

    if (offers?.beratung){
      setText("offersBeratungTitle", offers.beratung.title || "Beratung");
      setText("offersBeratungText", offers.beratung.text);
      mountOptionalImage("offersBeratungMedia", offers.beratung.image, offers.beratung.title || "Beratung");
      const body = document.querySelector("#accBeratung .offerAccBody");
      addOptionalLinkButton(body, offers.beratung.link, offers.beratung.link_label || "Mehr", "btn btnGhost");
      renderSubs("offersBeratungSubs", offers.beratung.sub);
    }

    document.querySelectorAll("details.offerAcc").forEach((d) => {
      const icon = d.querySelector(".offerAccIcon");
      const sync = () => { if (icon) icon.textContent = d.open ? "–" : "+"; };
      sync();
      d.addEventListener("toggle", sync);
    });
  }

  function mountFaq(faqData, fallbackHint){
    if (faqData?.title) setText("faqTitle", faqData.title);
    if (faqData?.hint) setText("faqHint", faqData.hint || fallbackHint);

    const items = Array.isArray(faqData?.items) ? faqData.items : [];
    const box = document.getElementById("faqBox");
    if (!box || !items.length) return;

    clearEl(box);

    items.slice(0, 12).forEach((it, idx) => {
      const wrap = document.createElement("div");
      wrap.className = "faqItem";

      const btn = document.createElement("button");
      btn.className = "faqQ";
      btn.type = "button";

      const span = document.createElement("span");
      span.textContent = String(it?.q || ("Frage " + (idx + 1)));

      const i = document.createElement("i");
      i.textContent = "+";

      btn.appendChild(span);
      btn.appendChild(i);

      const ans = document.createElement("div");
      ans.className = "faqA";
      ans.textContent = String(it?.a || "");

      wrap.appendChild(btn);
      wrap.appendChild(ans);
      box.appendChild(wrap);
    });

    initFaq();
  }

  function mountFeedbackFromJson(feedbackData){
    if (!feedbackData) return;

    if (feedbackData.title) setText("feedbackTitle", String(feedbackData.title).toUpperCase());
    if (feedbackData.kicker) setText("feedbackKicker", feedbackData.kicker);

    const items = Array.isArray(feedbackData.items) ? feedbackData.items : [];
    if (!items.length) return;

    [1,2,3,4].forEach((i) => {
      const it = items[i-1];
      if (!it) return;

      if (it.title) setText("fb" + i + "Title", String(it.title).toUpperCase());
      if (it.name) setText("fb" + i + "Name", it.name);
      if (it.text) setText("fb" + i + "Text", it.text);

      if (it.poster && safeUrl(it.poster)){
        mountOptionalImage("fb" + i + "Poster", it.poster, (it.title || "Feedback") + " Poster");
      }
      if (it.image && safeUrl(it.image)){
        mountOptionalImage("fb" + i + "Image", it.image, (it.title || "Feedback") + " Bild");
      }
    });

    initFeedbackDetailsPlus();
  }

  function initYouTubeFeedbackEmbeds(consent){
    const boxes = document.querySelectorAll(".ytBox");
    if (!boxes.length) return;

    boxes.forEach((box) => {
      const btn = box.querySelector(".ytBtn");
      const posterImg = box.querySelector(".ytPoster");

      const ytId = (box.getAttribute("data-yt-id") || "").trim();
      const ytTitle = (box.getAttribute("data-yt-title") || "YouTube Video").trim();
      const poster = safeUrl(box.getAttribute("data-yt-poster") || "");

      if (posterImg && poster) {
        posterImg.src = poster;
        posterImg.alt = ytTitle + " Poster";
      }

      const showBlockedHint = () => {
        if (!btn) return;
        btn.textContent = "Zustimmen, dann laden";
        btn.disabled = true;
        btn.style.opacity = ".6";
        btn.style.cursor = "not-allowed";
      };

      const loadIframe = () => {
        if (!consent) return;
        if (!ytId) return;

        const iframe = document.createElement("iframe");
        iframe.className = "ytFrame";
        iframe.title = ytTitle;
        iframe.loading = "lazy";
        iframe.allow = "accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share";
        iframe.allowFullscreen = true;

        const params = new URLSearchParams({
          autoplay: "1",
          rel: "0",
          modestbranding: "1",
          playsinline: "1"
        });

        iframe.src = `https://www.youtube-nocookie.com/embed/${encodeURIComponent(ytId)}?${params.toString()}`;

        clearEl(box);
        box.appendChild(iframe);
      };

      if (!consent) {
        showBlockedHint();
        return;
      }

      if (btn) {
        btn.addEventListener("click", loadIframe);
      } else {
        box.addEventListener("click", loadIframe);
      }
    });
  }

  (async () => {
    const cc = document.getElementById("cc");
    const ccAccept = document.getElementById("ccAccept");
    const ccDecline = document.getElementById("ccDecline");
    const CC_KEY = "movemania_cookie_consent";

    const currentConsent = localStorage.getItem(CC_KEY);

    if (cc && !currentConsent) {
      cc.style.display = "block";
    }

    const applyConsentState = () => {
      const consent = localStorage.getItem(CC_KEY) === "accepted";
      initYouTubeFeedbackEmbeds(consent);
    };

    if (ccAccept) {
      ccAccept.addEventListener("click", () => {
        localStorage.setItem(CC_KEY, "accepted");
        cc.style.display = "none";
        applyConsentState();
      });
    }

    if (ccDecline) {
      ccDecline.addEventListener("click", () => {
        localStorage.setItem(CC_KEY, "declined");
        cc.style.display = "none";
        applyConsentState();
      });
    }

    applyConsentState();
    initFeedbackDetailsPlus();

    try {
      const theme = await loadJSON("assets/content/theme.json");
      applyTheme(theme);
    } catch (e) {}

    /* Logo nur anzeigen, wenn es wirklich geladen ist */
    const logo = document.getElementById("logoImg");
    if (logo) {
      if (logo.complete && logo.naturalWidth > 0) {
        logo.style.display = "block";
      } else {
        logo.addEventListener("load", () => { logo.style.display = "block"; }, { once: true });
        logo.addEventListener("error", () => { logo.style.display = "none"; }, { once: true });
      }
    }

    let links = {};
    try { links = await loadJSON("assets/content/links.json"); } catch (e) {}

    let texts = {};
    try { texts = await loadJSON("assets/content/texts.json"); } catch (e) {}

    setText("heroBrand", (texts.hero_brand || "MOVEMANIA").toUpperCase());
    let claim = (texts.hero_title || "KINDER STÄRKEN.<br>SPIELER ENTWICKELN.").toUpperCase();
    claim = claim.replace(/^[\s\"“”„‚'«»]+|[\s\"“”„‚'«»]+$/g, "");
    setHtmlAllowBr("heroClaim", claim);
    setText("heroText", texts.hero_text || "In unseren Camps und Kursen entwickeln Kinder Freude an Bewegung – mit Struktur, Haltung und Herz.");

    setHref("navShop", links.shop);

    setHref("kIG", links.instagram);
    setHref("kWA", links.whatsapp);

    const mailHref = normalizeMailto(links.mailto || links.email);
    if (mailHref) setHref("kMail", mailHref);

    setText("kIGText", links.instagram_text || texts.contact_ig_label || "Updates & Einblicke");
    setText("kWAText", links.whatsapp_text || texts.contact_wa_label || "Community / Infos");

    const mailVisible =
      (links.mail_text && String(links.mail_text).trim()) ||
      (links.mailto && String(links.mailto).replace(/^mailto:/i, "").trim()) ||
      (links.email && String(links.email).trim()) ||
      (texts.contact_mail_label || "Direkt schreiben");

    setText("kMailText", mailVisible);

    mountContactIcon("kMailIcon", links.mail_icon || links.contact_icon_mail, "Mail");
    mountContactIcon("kIGIcon", links.instagram_icon || links.contact_icon_instagram, "Instagram");
    mountContactIcon("kWAIcon", links.whatsapp_icon || links.contact_icon_whatsapp, "WhatsApp");

    setText("aboutKicker", texts.about_kicker || "Über uns");
    setText("aboutTitle", (texts.about_title || "Wer wir sind").toUpperCase());
    setText("aboutHeadTitle", (texts.about_head_title || "Vorstellung Headcoach").toUpperCase());
    setText("aboutHeadText", texts.about_head_text || "Hier kommt eure Vorstellung (Headcoach) rein – kurz, klar, authentisch.");

    // Optional: Headcoach Steckbrief (texts.json fallback)
    const headProfileFallback =
      String(texts.about_head_profile || texts.about_head_steckbrief || "").trim();
    if (headProfileFallback){
      const details = document.getElementById("headcoachProfile");
      const textEl = document.getElementById("headcoachProfileText");
      if (details && textEl){
        details.style.display = "block";
        textEl.textContent = headProfileFallback;
      }
    } else {
      const details = document.getElementById("headcoachProfile");
      if (details) details.style.display = "none";
    }

    setText("uspKicker", (texts.usp_kicker || "Wofür wir stehen"));
    setText("uspTitle", (texts.usp_title || "Spaß · Mut · Einsatz").toUpperCase());
    setText("uspGhost", (texts.usp_ghost || "WERTE").toUpperCase());

    setText("feedbackTitle", (texts.feedback_title || "FEEDBACK").toUpperCase());
    setText("feedbackKicker", texts.feedback_kicker || "Stimmen von Eltern & Kindern");

    try {
      const feedbackData = await loadJSON("assets/content/feedback.json");
      mountFeedbackFromJson(feedbackData);
    } catch (e) {}

    try {
      const sponsorsData = await loadJSON("assets/content/sponsors.json");
      mountSponsors(sponsorsData);
    } catch (e) {}

    try {
      const headcoachData = await loadJSON("assets/content/headcoach.json");
      mountHeadcoachMedia(headcoachData);
      mountHeadcoachProfile(headcoachData);
    } catch (e) {}

    try {
      const coachesData = await loadJSON("assets/content/coaches.json");
      mountCoaches(coachesData);
    } catch (e) {}

    try {
      const valuesData = await loadJSON("assets/content/values.json");
      mountValues(valuesData);
    } catch (e) {}

    try {
      const offersData = await loadJSON("assets/content/offers.json");
      mountOffers(offersData);
    } catch (e) {}

    try {
      const faqData = await loadJSON("assets/content/faq.json");
      mountFaq(faqData, texts.faq_hint || "");
    } catch (e) {
      initFaq();
    }

    let heroSlides = null;
    try {
      heroSlides = await loadJSON("assets/content/hero.json");
    } catch (e) {}

    if (heroSlides && heroSlides.slides) heroSlides = heroSlides.slides;

    if (!heroSlides) {
      heroSlides = [
        {
          type: "video",
          src: links.hero_video_mp4 || "assets/video/hero.mp4",
          poster: links.hero_video_poster || "assets/img/hero.jpg",
          title: texts.hero_slide1_title || "Vorstellung",
          text: texts.hero_slide1_text || "Hier steht später die Vorstellung / kurze Einordnung."
        },
        {
          type: "image",
          src: texts.hero_slide2_img || "assets/img/placeholder-1.jpg",
          title: texts.hero_slide2_title || "Wofür wir stehen",
          text: texts.hero_slide2_text || "Werte, Haltung, Herz – kurz und klar."
        },
        {
          type: "image",
          src: texts.hero_slide3_img || "assets/img/placeholder-2.jpg",
          title: texts.hero_slide3_title || "Was wir machen",
          text: texts.hero_slide3_text || "Camps, Kurse, Ballschule – Überblick."
        }
      ];
    }

    // sanitize slide URLs
    heroSlides = Array.isArray(heroSlides) ? heroSlides.map((s) => ({
      type: String(s?.type || "image"),
      src: safeUrl(s?.src || ""),
      poster: safeUrl(s?.poster || ""),
      title: String(s?.title || ""),
      text: String(s?.text || "")
    })) : heroSlides;

    mountHeroSlider(heroSlides);
  })();
</script>

<!-- Netlify Identity Token Catcher -->
<script>
(function () {
  const hash = window.location.hash || "";
  if (
    hash.includes("confirmation_token=") ||
    hash.includes("invite_token=") ||
    hash.includes("recovery_token=")
  ) {
    window.location.replace("/admin/" + hash);
  }
})();
</script>

</body>
</html>
